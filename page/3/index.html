<!doctype html>
<html class="theme-next   use-motion ">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  
    <link href='//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.4.5.2" rel="stylesheet" type="text/css" />



  <meta name="description" content="Lyn's Blog about Node.js  Express.js Angular.js HTML5 Mongodb Programing Notes" />




  <meta name="keywords" content="Lyn's blog" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.2" />






<meta name="description" content="Lyn&apos;s Blog about Node.js  Express.js Angular.js HTML5 Mongodb Programing Notes">
<meta property="og:type" content="website">
<meta property="og:title" content="Lyn's Blog">
<meta property="og:url" content="http://lyn.s76.org/page/3/index.html">
<meta property="og:site_name" content="Lyn's Blog">
<meta property="og:description" content="Lyn&apos;s Blog about Node.js  Express.js Angular.js HTML5 Mongodb Programing Notes">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Lyn's Blog">
<meta name="twitter:description" content="Lyn&apos;s Blog about Node.js  Express.js Angular.js HTML5 Mongodb Programing Notes">



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'post',
    motion: true
  };
</script>

  <title> Lyn's Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-hk">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36568696-2', 'auto');
  ga('send', 'pageview');

</script>








  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Lyn's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Node.js Angular.js Express.js HTML5 Mongodb Programing Notes</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首頁
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            歸檔
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            標籤
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
  <section id="posts" class="posts-expand">
    
      

  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                <a class="post-title-link" href="/2016/05/19/JRE-setup-doc/" itemprop="url">
                  Setup Java Eclipse Tomcat & FreeMarker on Mac
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-05-19T09:07:51+08:00" content="2016-05-19">
              2016-05-19
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h2 id="Install_Homebrew">Install <a href="http://brew.sh/" target="_blank" rel="external">Homebrew</a></h2><ul>
<li>Open Terminal.</li>
<li>If you don’t already have Homebrew installed:<ul>
<li>Run command to install Homebrew.<ul>
<li><code>ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code></li>
</ul>
</li>
</ul>
</li>
<li>Make sure that it is up to date.<ul>
<li><code>brew update</code></li>
</ul>
</li>
<li>Check that there would not be any potential problems in your system.<ul>
<li><code>brew doctor</code></li>
</ul>
</li>
<li>Upgrade Homebrew packages.<ul>
<li><code>brew upgrade</code></li>
</ul>
</li>
</ul>
<h2 id="Install_JAVA_SDK">Install JAVA SDK</h2><p>Check if Java installed</p>
<p><code>java -version</code></p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Lyn-Cheung-MBP: Lyn$ <span class="keyword">java </span>-version</div><div class="line"><span class="keyword">java </span>version <span class="string">"1.7.0_79"</span></div><div class="line"><span class="keyword">Java(TM) </span>SE Runtime Environment (<span class="keyword">build </span><span class="number">1</span>.<span class="number">7</span>.<span class="number">0</span>_79-<span class="keyword">b15)</span></div><div class="line"><span class="keyword">Java </span>HotSpot(TM) <span class="number">64</span>-<span class="keyword">Bit </span>Server VM (<span class="keyword">build </span><span class="number">24</span>.<span class="number">79</span>-<span class="keyword">b02, </span>mixed mode)</div></pre></td></tr></table></figure>
<p>Java SE Development Kit 8 Downloads</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http:<span class="regexp">//</span>www.oracle.com<span class="regexp">/technetwork/</span>java<span class="regexp">/javase/</span>downloads<span class="regexp">/jdk8-downloads-2133151.html</span></div></pre></td></tr></table></figure>
<p>edit  <code>~/.bash_profile</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">cat ~/.bash_profile</div><div class="line"><span class="built_in">export</span> PATH=<span class="variable">$&#123;PATH&#125;</span>:/Development/android-sdk/tools</div><div class="line"><span class="built_in">export</span> JAVA_HOME=$(/usr/libexec/java_home)</div><div class="line"><span class="built_in">export</span> PATH=<span class="variable">$&#123;JAVA_HOME&#125;</span>/bin:<span class="variable">$PATH</span></div><div class="line"><span class="built_in">export</span> PATH=/usr/<span class="built_in">local</span>/bin:<span class="variable">$PATH</span></div><div class="line"><span class="built_in">export</span> path=/usr/<span class="built_in">local</span>/bin:<span class="variable">$path</span></div></pre></td></tr></table></figure>
<p>reload bash_profile</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="built_in">source</span> ~/.bash_profile</div></pre></td></tr></table></figure>
<h2 id="Eclipse">Eclipse</h2><ul>
<li>Download and install latest version of <em>Eclipse IDE for Java EE developers</em> from <a href="http://www.eclipse.org/downloads/" target="_blank" rel="external">Eclipse Downloads</a></li>
</ul>
<h3 id="Set_Eclipse_to_use_the_previously_installed_version_of_Java">Set Eclipse to use the previously installed version of Java</h3><ul>
<li>If you have multiple versions of Java installed, set the Eclipse to use the version installed earlier in these instructions.</li>
<li><em>Window &gt;&gt; Preferences &gt;&gt; Java &gt;&gt; Installed JREs</em> Add the path to the Java version you installed (e.g. <em>/usr/lib/jvm/java-7-oracle (java-7-oracle)</em> )</li>
</ul>
<h2 id="Installing_Tomcat_8">Installing Tomcat 8</h2><ul>
<li><p><code>brew install tomcat</code>: <a href="http://blog.bolshchikov.net/post/50277857673/installing-tomcat-on-macos-with-homebrew" target="_blank" rel="external">Installing Tomcat on MacOS with homebrew</a></p>
<ul>
<li><code>sudo ln -s /usr/local/Cellar/tomcat/8.0.14/libexec /Library/Tomcat</code></li>
<li><code>sudo chown -R /Library/Tomcat</code></li>
<li><code>sudo chmod +x /Library/Tomcat/bin/*.sh</code></li>
</ul>
</li>
<li><p>In Eclipse:</p>
<ul>
<li><em>Eclipse &gt;&gt; Preferences</em></li>
<li><em>Server &gt;&gt; Runtime Environment</em></li>
<li>Click <em>“Add…”</em></li>
<li>Under <em>“Apache”</em> select <em>“Tomcat v8.0”</em></li>
<li>Click <em>“Next”</em></li>
<li>Click <em>“Browse…”</em></li>
<li>Select the folder where you installed Tomcat (e.g.<em>/usr/local/Cellar/tomcat/8.0.33/libexec</em>)</li>
<li>Click <em>“Finish”</em></li>
</ul>
</li>
</ul>
<h2 id="MySQL">MySQL</h2><ul>
<li>Install MySQL<ul>
<li><code>brew install mysql</code></li>
</ul>
</li>
<li>To have launchd start mysql at login:<ul>
<li><code>ln -sfv /usr/local/opt/mysql/*.plist ~/Library/LaunchAgents</code></li>
</ul>
</li>
<li>Then to load mysql now:<ul>
<li><code>launchctl load ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist</code></li>
</ul>
</li>
<li>Or, if you don’t want/need launchctl, you can just run:<ul>
<li><code>mysql.server start</code></li>
</ul>
</li>
</ul>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                <a class="post-title-link" href="/2016/05/12/react-js-02-router/" itemprop="url">
                  react.js-Notes-02 react-router
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-05-12T20:34:25+08:00" content="2016-05-12">
              2016-05-12
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="install_react_router_to_your_project">install react router to your project</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm <span class="keyword">install</span> react-router <span class="comment">--save</span></div></pre></td></tr></table></figure>
<h1 id="clean_index-html">clean index.html</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"https://maxcdn.bootstrapcdn.com/bootswatch/3.3.6/flatly/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">integrity</span>=<span class="string">"sha384-XYCjB+hFAjSbgf9yKUgbysEjaVLOXhCgATTEBpCqT1R3jvG5LGRAK5ZIyRbH5vpX"</span> <span class="attr">crossorigin</span>=<span class="string">"anonymous"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Some page <span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="css"> <span class="selector-class">.md-scroll-mask</span> &#123; <span class="attribute">position</span>: initial;&#125;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./scripts.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<h1 id="-/js/scripts-js">./js/scripts.js</h1><p>import Router Route and IndexRoute</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">"react-dom"</span>;</div><div class="line"><span class="keyword">import</span> &#123; Router, Route, IndexRoute, hashHistory &#125; <span class="keyword">from</span> <span class="string">"react-router"</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> Archives  <span class="keyword">from</span> <span class="string">"./pages/Archives"</span>;</div><div class="line"><span class="keyword">import</span> Featured <span class="keyword">from</span> <span class="string">"./pages/Featured"</span>;</div><div class="line"><span class="keyword">import</span> Layout <span class="keyword">from</span> <span class="string">"./pages/Layout"</span>;</div><div class="line"><span class="keyword">import</span> Settings <span class="keyword">from</span> <span class="string">"./pages/Settings"</span>;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">const</span> app = <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>);</div><div class="line"></div><div class="line">ReactDOM.render(</div><div class="line">	<span class="xml"><span class="tag">&lt;<span class="name">Router</span>  <span class="attr">history</span>=<span class="string">&#123;hashHistory&#125;</span> &gt;</span></span></div><div class="line">		<span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">"/"</span> <span class="attr">component</span>=<span class="string">&#123;Layout&#125;</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">IndexRoute</span> <span class="attr">component</span>=<span class="string">&#123;Featured&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">IndexRoute</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">"archives(/:article)"</span>  <span class="attr">name</span>=<span class="string">"archives"</span> <span class="attr">component</span>=<span class="string">&#123;Archives&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">"settings"</span>  <span class="attr">name</span>=<span class="string">"settings"</span><span class="attr">component</span>=<span class="string">&#123;Settings&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">Route</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">Router</span>&gt;</span>,</div><div class="line"> app);</div></pre></td></tr></table></figure>
<h1 id="-/js/pages/">./js/pages/</h1><h2 id="-/js/pages/Layout-js">./js/pages/Layout.js</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> Nav <span class="keyword">from</span> <span class="string">"../components/layout/Nav"</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Layout</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line"></div><div class="line"></div><div class="line">render() &#123;</div><div class="line">		<span class="keyword">const</span>&#123; location &#125; =<span class="keyword">this</span>.props;</div><div class="line">		<span class="keyword">const</span> containerStyle = &#123; </div><div class="line">			<span class="attr">marginTop</span>:  <span class="string">"60px"</span></div><div class="line">		&#125;;</div><div class="line">	</div><div class="line">		<span class="keyword">return</span> (</div><div class="line">			<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">				<span class="tag">&lt;<span class="name">Nav</span> <span class="attr">location</span> =<span class="string">&#123;location&#125;</span> /&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span> <span class="attr">style</span>=<span class="string">&#123;containerStyle&#125;</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></div><div class="line">		          			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-lg-12"</span>&gt;</span></div><div class="line">								<span class="tag">&lt;<span class="name">h1</span>&gt;</span> Hello World <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">								&#123;this.props.children&#125;</div><div class="line">						<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">					<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">				<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">			</div><div class="line">		);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="-/js/pages/Archives-js">./js/pages/Archives.js</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</div><div class="line"><span class="keyword">import</span> &#123; Link &#125; <span class="keyword">from</span> <span class="string">"react-router"</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> Article <span class="keyword">from</span> <span class="string">"../components/Article"</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Archives</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line"></div><div class="line">	render() &#123;</div><div class="line">		<span class="keyword">const</span> &#123; query &#125; = <span class="keyword">this</span>.props.location;</div><div class="line">		<span class="keyword">const</span> &#123; article &#125; = <span class="keyword">this</span>.props.params;</div><div class="line">		<span class="keyword">const</span> &#123; date, filter &#125;  = query;</div><div class="line">		<span class="comment">//console.log(this.props);</span></div><div class="line">		<span class="keyword">const</span> Articles = [</div><div class="line">			<span class="string">"Some Article"</span>,</div><div class="line">			<span class="string">"Some Other Article"</span>,</div><div class="line">			<span class="string">"Yet  Another Article "</span>,</div><div class="line">			<span class="string">"Still More"</span>,</div><div class="line">			<span class="string">"Fake Article"</span>,</div><div class="line">			<span class="string">"Partial Another  "</span>,</div><div class="line">			<span class="string">"Still More"</span>,</div><div class="line">		].map(<span class="function">(<span class="params">title, i</span>) =&gt;</span>  &lt;Article key=&#123;i&#125;  title=&#123;title&#125; /&gt; );</div><div class="line"></div><div class="line">		<span class="keyword">return</span> (</div><div class="line">			<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">				<span class="tag">&lt;<span class="name">h1</span>&gt;</span> Archives <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">p</span>&gt;</span>hello  this  is  archives<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">h4</span>&gt;</span>date: &#123;date&#125;, filter: &#123;filter&#125; <span class="tag">&lt;/<span class="name">h4</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span>&#123;Articles&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">			);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="-/js/pages/Featured-js">./js/pages/Featured.js</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> Article <span class="keyword">from</span> <span class="string">"../components/Article"</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Featured</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line">	render() &#123;</div><div class="line">		<span class="keyword">const</span> Articles = [</div><div class="line">			<span class="string">"Some Article"</span>,</div><div class="line">			<span class="string">"Some Other Article"</span>,</div><div class="line">			<span class="string">"Yet  Another Article "</span>,</div><div class="line">			<span class="string">"Still More"</span>,</div><div class="line">		].map(<span class="function">(<span class="params">title, i</span>) =&gt;</span>  &lt;Article key=&#123;i&#125;  title=&#123;title&#125; /&gt; );</div><div class="line"></div><div class="line">		<span class="keyword">return</span> (</div><div class="line">			<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span>&#123;Articles&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">			);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="-/js/page/Settings-js">./js/page/Settings.js</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</div><div class="line"><span class="keyword">import</span> &#123; Link &#125; <span class="keyword">from</span> <span class="string">"react-router"</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Settings</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line">	render() &#123;</div><div class="line">		<span class="keyword">return</span> (</div><div class="line">			<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">				<span class="tag">&lt;<span class="name">h1</span>&gt;</span> Settings <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">p</span>&gt;</span>hello  this  is  Settings<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">			);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="-/js/components/layout/">./js/components/layout/</h1><h2 id="-/js/components/layout/Nav-js">./js/components/layout/Nav.js</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</div><div class="line"><span class="keyword">import</span> &#123; IndexLink, Link &#125; <span class="keyword">from</span> <span class="string">"react-router"</span>;</div><div class="line"> </div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Nav</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line">	<span class="keyword">constructor</span>()&#123;</div><div class="line">		<span class="keyword">super</span>()</div><div class="line">		<span class="keyword">this</span>.state=&#123;</div><div class="line">			<span class="attr">collapsed</span> : <span class="literal">true</span>,</div><div class="line">		&#125;;</div><div class="line">	&#125;</div><div class="line">	toggleCollapse()&#123;</div><div class="line">		<span class="keyword">const</span> collapsed = !<span class="keyword">this</span>.state.collapsed;</div><div class="line">		<span class="keyword">this</span>.setState(&#123;collapsed&#125;);</div><div class="line">	&#125;</div><div class="line">	render() &#123;</div><div class="line">		<span class="keyword">const</span> &#123; location &#125; = <span class="keyword">this</span>.props;</div><div class="line">		<span class="keyword">const</span> &#123; collapsed &#125; = <span class="keyword">this</span>.state;</div><div class="line">		<span class="keyword">const</span> featuredClass = location.pathname ===<span class="string">"/"</span> ? <span class="string">"active"</span>:<span class="string">""</span>;</div><div class="line">		<span class="keyword">const</span> archivesClass = location.pathname.match(<span class="regexp">/^\/archives/</span>) ? <span class="string">"active"</span>:<span class="string">""</span>;</div><div class="line">		<span class="keyword">const</span> settingsClass =  location.pathname.match(<span class="regexp">/^\/settings/</span>) ? <span class="string">"active"</span>:<span class="string">""</span>;</div><div class="line">		<span class="keyword">const</span> navClass = collapsed ? <span class="string">"collapse"</span> : <span class="string">""</span>;</div><div class="line">		 </div><div class="line">		<span class="keyword">return</span> (</div><div class="line">			   <span class="xml"><span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"navbar navbar-default navbar-fixed-top"</span> <span class="attr">role</span>=<span class="string">"navgation"</span>&gt;</span></span></div><div class="line">			      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">				        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"navbar-header"</span>&gt;</span>        </div><div class="line">				          <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"navbar-toggle"</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onClick</span>=<span class="string">&#123;this.toggleCollapse.bind(this)&#125;</span>&gt;</span></div><div class="line">					            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">					            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">					            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">				          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">				        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">			        	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#123;</span>"<span class="attr">navbar-collapse</span> "+ <span class="attr">navClass</span>&#125; <span class="attr">id</span>=<span class="string">"navbar-main"</span>&gt;</span></div><div class="line">				          <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"nav navbar-nav"</span>&gt;</span></div><div class="line"></div><div class="line">					            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;featuredClass&#125;"</span>&gt;</span></div><div class="line">					            <span class="tag">&lt;<span class="name">IndexLink</span> <span class="attr">to</span>=<span class="string">"/"</span>  <span class="attr">onClick</span>=<span class="string">&#123;this.toggleCollapse.bind(this)&#125;</span>&gt;</span> Featured <span class="tag">&lt;/<span class="name">IndexLink</span>&gt;</span></div><div class="line">					            <span class="tag">&lt;/<span class="name">li</span>&gt;</span>   </div><div class="line">					            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;archivesClass&#125;"</span>&gt;</span></div><div class="line">					            <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">"archives"</span>  <span class="attr">onClick</span>=<span class="string">&#123;this.toggleCollapse.bind(this)&#125;</span>&gt;</span> Archives <span class="tag">&lt;/<span class="name">Link</span>&gt;</span></div><div class="line">					            <span class="tag">&lt;/<span class="name">li</span>&gt;</span>   </div><div class="line">					            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"&#123;settingsClass&#125;"</span>&gt;</span></div><div class="line">					            <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">"settings"</span>  <span class="attr">onClick</span>=<span class="string">&#123;this.toggleCollapse.bind(this)&#125;</span>&gt;</span> Settings <span class="tag">&lt;/<span class="name">Link</span>&gt;</span></div><div class="line">					            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">	 </div><div class="line">				          <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line">			        	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">			      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">			    <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></div><div class="line">			</div><div class="line">			);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="-/js/components">./js/components</h1><h2 id="-/js/components/Article-js">./js/components/Article.js</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> <span class="type">React</span> from <span class="string">"react"</span>;</div><div class="line"></div><div class="line">export <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line">	render()&#123;</div><div class="line"></div><div class="line">		const  &#123; title &#125;= <span class="keyword">this</span>.props;</div><div class="line"></div><div class="line">	<span class="keyword">return</span>(</div><div class="line">		&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-md-4"</span>&gt;</div><div class="line">				&lt;h2&gt;&#123;title&#125;&lt;/h2&gt;</div><div class="line">				&lt;p&gt; <span class="type">Lorem</span> ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod</div><div class="line">					tempor incididunt ut labore et dolore magna aliqua. <span class="type">Ut</span> enim ad minim veniam,</div><div class="line">					quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo</div><div class="line">					consequat. &lt;/p&gt;</div><div class="line">				&lt;a <span class="class"><span class="keyword">class</span></span>=<span class="string">"btn btn-default"</span> href=<span class="string">"#"</span>&gt; <span class="type">More</span> <span class="type">Info</span> &lt;/a&gt;</div><div class="line">		&lt;/div&gt;</div><div class="line">		);</div><div class="line"></div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                <a class="post-title-link" href="/2016/05/11/react-js-01/" itemprop="url">
                  react.js-Notes-01
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-05-11T22:08:32+08:00" content="2016-05-11">
              2016-05-11
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="config_before_development">config before development</h1><h2 id="npm">npm</h2><p>use command to initialize your package.json file </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm init <span class="_">-f</span></div></pre></td></tr></table></figure>
<p>my npm package.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"name"</span>: <span class="string">"Test"</span>,</div><div class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</div><div class="line">  <span class="attr">"description"</span>: <span class="string">""</span>,</div><div class="line">  <span class="attr">"main"</span>: <span class="string">"index.js"</span>,</div><div class="line">  <span class="attr">"scripts"</span>: &#123;</div><div class="line">    <span class="attr">"dev"</span>: <span class="string">"webpack-dev-server --content-base src  --inline --hot"</span>,</div><div class="line">    <span class="attr">"lint"</span>: <span class="string">"eslint js"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"author"</span>: <span class="string">""</span>,</div><div class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</div><div class="line">  <span class="attr">"dependencies"</span>: &#123;</div><div class="line">    <span class="attr">"babel-plugin-add-module-exports"</span>: <span class="string">"^0.1.2"</span>,</div><div class="line">    <span class="attr">"babel-plugin-react-html-attrs"</span>: <span class="string">"^2.0.0"</span>,</div><div class="line">    <span class="attr">"babel-plugin-transform-class-properties"</span>: <span class="string">"^6.3.13"</span>,</div><div class="line">    <span class="attr">"babel-plugin-transform-decorators-legacy"</span>: <span class="string">"^1.3.4"</span>,</div><div class="line">    <span class="attr">"react"</span>: <span class="string">"^15.0.1"</span>,</div><div class="line">    <span class="attr">"react-dom"</span>: <span class="string">"^15.0.1"</span>,</div><div class="line">    <span class="attr">"webpack"</span>: <span class="string">"^1.13.0"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"devDependencies"</span>: &#123;</div><div class="line">    <span class="attr">"babel-core"</span>: <span class="string">"^6.7.7"</span>,</div><div class="line">    <span class="attr">"babel-eslint"</span>: <span class="string">"^6.0.4"</span>,</div><div class="line">    <span class="attr">"babel-loader"</span>: <span class="string">"^6.2.4"</span>,</div><div class="line">    <span class="attr">"babel-preset-es2015"</span>: <span class="string">"^6.6.0"</span>,</div><div class="line">    <span class="attr">"babel-preset-react"</span>: <span class="string">"^6.5.0"</span>,</div><div class="line">    <span class="attr">"babel-preset-stage-0"</span>: <span class="string">"^6.5.0"</span>,</div><div class="line">    <span class="attr">"eslint"</span>: <span class="string">"^2.9.0"</span>,</div><div class="line">    <span class="attr">"eslint-plugin-react"</span>: <span class="string">"^5.0.1"</span>,</div><div class="line">    <span class="attr">"webpack-dev-server"</span>: <span class="string">"^1.14.1"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>after you edit your package.json file, you can run npm install to install all the dependencies automatically</p>
<h2 id="webpack">webpack</h2><p>after all the packages is  installled.</p>
<p>we can config webpack by create webpack.config.js file under your project path.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> debug   = process.env.NODE_ENV !==<span class="string">"production"</span>;</div><div class="line"><span class="keyword">var</span> webpack =<span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports=&#123;</div><div class="line">	context: __dirname+<span class="string">"/src"</span>,</div><div class="line">	devtool: debug ? <span class="string">"inline-sourcemap"</span> : <span class="literal">null</span>,</div><div class="line">	entry:<span class="string">"./js/scripts.js"</span>,</div><div class="line">	output:&#123;</div><div class="line">		path: __dirname +<span class="string">"/src"</span>,</div><div class="line">		filename:<span class="string">"scripts.min.js"</span></div><div class="line">	&#125;,</div><div class="line">	devServer:&#123;</div><div class="line">		inline:<span class="literal">true</span>,</div><div class="line">		port:<span class="number">1336</span></div><div class="line">	&#125;,</div><div class="line">	<span class="keyword">module</span>:&#123;</div><div class="line">		loaders:[</div><div class="line">		&#123;</div><div class="line">			test:<span class="regexp">/\.js$/</span>,</div><div class="line">			exclude:<span class="regexp">/node_modules|bower_components/</span>,</div><div class="line">			loader:<span class="string">'babel-loader'</span>,</div><div class="line">			query:&#123;</div><div class="line">				presets:[<span class="string">'es2015'</span>,<span class="string">'react'</span>,<span class="string">'stage-0'</span>],</div><div class="line">				plugins:[<span class="string">'react-html-attrs'</span>,<span class="string">'transform-class-properties'</span>, <span class="string">'transform-decorators-legacy'</span>]</div><div class="line">			&#125;</div><div class="line">		 &#125;,</div><div class="line">	    ]</div><div class="line">	&#125;,</div><div class="line">	plugins: debug ? []:[</div><div class="line">		<span class="keyword">new</span> webpack.optimize.DedupePlugin(),</div><div class="line">		<span class="keyword">new</span> webpack.optimize.OccurenceOrderPlugin(),</div><div class="line">		<span class="keyword">new</span> webpack.optimize.UglifyJsPlugin(&#123; mangle:<span class="literal">false</span>, sourcemap:<span class="literal">false</span>&#125;),</div><div class="line">	],</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="eslint">eslint</h2><p>as jshint doesnot support react.js very well,<br>I replace jshint with eslint.<br>you can also install eslint sublime plugin to help you check your code in Sublime.</p>
<p>install eslint locally in your project folder (you must have package.json file there):</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm <span class="keyword">install</span> eslint</div></pre></td></tr></table></figure>
<p>Init eslint config if you don’t have any. Run in your code folder:</p>
<!--if eslint is installed locally-->
<figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./node_modules/.bin/eslint <span class="comment">--init</span></div></pre></td></tr></table></figure>
<p>To install via Package Control, do the following:</p>
<ol>
<li><p>Within Sublime Text, bring up the Command Palette and type install. Among the commands you should see Package Control: Install Package. If that command is not highlighted, use the keyboard or mouse to select it. There will be a pause of a few seconds while Package Control fetches the list of available plugins.</p>
</li>
<li><p>When the plugin list appears, type eslint. Among the entries you should see SublimeLinter-contrib-eslint. If that entry is not highlighted, use the keyboard or mouse to select it.</p>
</li>
</ol>
<p>my .eslintrc config file:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&#123;</div><div class="line">    <span class="attr">"env"</span>: &#123;</div><div class="line">        <span class="attr">"browser"</span>: <span class="literal">true</span>,</div><div class="line">        <span class="attr">"node"</span>: <span class="literal">true</span>,</div><div class="line">        <span class="attr">"es6"</span>: <span class="literal">true</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"extends"</span>: <span class="string">"eslint:recommended"</span>,</div><div class="line">    <span class="attr">"parser"</span>: <span class="string">"babel-eslint"</span>,</div><div class="line">    <span class="attr">"ecmaFeatures"</span>: &#123;</div><div class="line">       <span class="attr">"jsx"</span>: <span class="literal">true</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"rules"</span>: &#123;</div><div class="line">        <span class="attr">"semi"</span>: [<span class="number">2</span>, <span class="string">"always"</span>]</div><div class="line">    &#125;</div><div class="line">    <span class="string">"plugins"</span>: [</div><div class="line">        <span class="string">"react"</span></div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="your_first_react-js_component">your first react.js component</h1><h2 id="Folder_Structure">Folder Structure</h2><p> Lyn-Cheung-MBP:01 Lyn$ find . -print | sed -e ‘s;[^/]*/;|<strong><strong>;g;s;</strong></strong>|; `|;g’</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">|<span class="string">____package.json</span></div><div class="line">|____src</div><div class="line">|<span class="string"> </span>|<span class="string">____index.html</span></div><div class="line">|<span class="string"> </span>|____js</div><div class="line">|<span class="string"> </span>|<span class="string"> </span>|____components</div><div class="line">|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">____Footer.js</span></div><div class="line">|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|____Header</div><div class="line">|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">____Title.js</span></div><div class="line">|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">____Header.js</span></div><div class="line">|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">____Layout.js</span></div><div class="line">|<span class="string"> </span>|<span class="string"> </span>|<span class="string">____scripts.js</span></div><div class="line">|<span class="string"> </span>|<span class="string"> </span>|<span class="string">____scripts.min.js</span></div><div class="line">|<span class="string"> </span>|<span class="string">____scripts.min.js</span></div><div class="line">|<span class="string">____webpack.config.js</span></div></pre></td></tr></table></figure>
<h2 id="Code_files">Code files</h2><p>index.html is very simple:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>Some page <span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">	 </div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">script</span>  <span class="attr">src</span>=<span class="string">"./scripts.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>scripts.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">"react-dom"</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> Layout <span class="keyword">from</span> <span class="string">"./components/Layout"</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">const</span> app =<span class="built_in">document</span>.getElementById(<span class="string">'app'</span>);</div><div class="line"></div><div class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">Layout</span>/&gt;</span></span>, app);</div></pre></td></tr></table></figure>
<p>Layout.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</div><div class="line"><span class="keyword">import</span> Header <span class="keyword">from</span> <span class="string">"./Header"</span>;</div><div class="line"><span class="keyword">import</span> Footer <span class="keyword">from</span> <span class="string">"./Footer"</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Layout</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line"> 	 <span class="keyword">constructor</span>()&#123;</div><div class="line"> 	 	<span class="keyword">super</span>();</div><div class="line"> 	 	<span class="keyword">this</span>.state=&#123;</div><div class="line"> 	 		<span class="attr">title</span>:<span class="string">"Welcome"</span>,</div><div class="line"> 	 	&#125;</div><div class="line"> 	 &#125;</div><div class="line"> 	 changeTitle(title)&#123;</div><div class="line"> 	 	<span class="keyword">this</span>.setState(&#123;title&#125;);</div><div class="line"> 	 &#125;</div><div class="line">	</div><div class="line">	render()&#123;</div><div class="line">		<span class="keyword">return</span> (</div><div class="line">			<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">				<span class="tag">&lt;<span class="name">Header</span> <span class="attr">changeTitle</span>=<span class="string">&#123;this.changeTitle.bind(this)&#125;</span> <span class="attr">title</span>=<span class="string">&#123;this.state.title&#125;</span> /&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">Footer</span> /&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">			);</div><div class="line">	</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Header.js</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> <span class="type">React</span> from <span class="string">"react"</span>;</div><div class="line"><span class="keyword">import</span> <span class="type">Title</span> from <span class="string">"./Header/Title"</span>;</div><div class="line"></div><div class="line">export <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Header</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line">	 handleChange(e)&#123;</div><div class="line">	 	const title =e.target.value;</div><div class="line">	 	<span class="keyword">this</span>.props.changeTitle(title);</div><div class="line">	 &#125;</div><div class="line">	</div><div class="line">	render()&#123;</div><div class="line">		<span class="keyword">return</span> (</div><div class="line">			&lt;div&gt;</div><div class="line">				&lt;<span class="type">Title</span>  title=&#123;<span class="keyword">this</span>.props.title&#125; /&gt;</div><div class="line">				&lt;input value=&#123;<span class="keyword">this</span>.props.title&#125;  onChange=&#123;<span class="keyword">this</span>.handleChange.bind(<span class="keyword">this</span>)&#125;  /&gt;</div><div class="line">			&lt;/div&gt;</div><div class="line">		);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Title.js</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> <span class="type">React</span> from <span class="string">"react"</span>;</div><div class="line"></div><div class="line">export <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Title</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line">	 </div><div class="line">	</div><div class="line">	render()&#123;</div><div class="line">		<span class="keyword">return</span> (</div><div class="line">			&lt;h1&gt; &#123;<span class="keyword">this</span>.props.title&#125;&lt;/h1&gt;</div><div class="line">			);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Footer.js</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> <span class="type">React</span> from <span class="string">"react"</span>;</div><div class="line"></div><div class="line">export <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Footer</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line">	render()&#123;</div><div class="line">		<span class="keyword">return</span> (</div><div class="line">			&lt;footer&gt; <span class="type">This</span> is <span class="type">Footer</span> &lt;/footer&gt;</div><div class="line">			);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Run_your_react-js_on_your_local_sever">Run your react.js on your local sever</h2><p>simply use these commands:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">webpack</div><div class="line"></div><div class="line">npm <span class="keyword">run</span><span class="bash"> dev</span></div></pre></td></tr></table></figure>
<p>then you can visit your first react.js project on your browser by:<br><a href="http://127.0.0.1:1336/" target="_blank" rel="external">http://127.0.0.1:1336/</a> </p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                <a class="post-title-link" href="/2016/04/22/css/" itemprop="url">
                  css权重优先级问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-04-22T11:58:01+08:00" content="2016-04-22">
              2016-04-22
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>CSS的选择器是有权重的，当不同选择器的样式设置有冲突时，会采用权重高的选择器设置样式。<br>权重（即优先级）的规则如下，权重越高，优先级越高：<br>  同一个元素可以使用多个规则来指定它的同一样式（比如字体颜色），每个规则都有自己的选择器。显然最终只有一个规则起作用（不可能一个字既是红色又是绿色），那么该规则的特殊性最高，特殊性即css优先级。<br> 很多人仅仅知道选择器优先级：ID&gt;class&gt;元素选择器，而不知道ID的优先级为什么大于class的优先级。</p>
<h1 id="那么css优先级到底是怎么计算的呢？">那么css优先级到底是怎么计算的呢？</h1><p>选择器的特殊性值表述为4个部分，用0,0,0,0表示：<br> 行间样式，加1,0,0,0.<br> ID选择器的特殊性值，加0,1,0,0。<br> 类选择器、属性选择器或伪类，加0,0,1,0。<br> 元素和伪元素，加0,0,0,1。<br> 通配选择器*对特殊性没有贡献，即0,0,0,0。</p>
<p> 最后比较特殊的一个标志!important（权重），它没有特殊性值，但它的优先级是最高的，为了方便记忆，可以认为它的特殊性值为1,0,0,0,0。<br> 选择器特殊性值是从左向右排序的，特殊性值1,0,0,0大于以0开头的所有特殊性值，即便它是0,99,99,99，优先级依然比1,0,0,0要低。</p>
<p>  很多人都知道a标签有四种状态：链接访问前、链接访问后、鼠标滑过、激活，分别对应四种伪类:link、:visited、:hover、:active，并且这四个伪类如果对同一个元素设置同一个属性，那它们的声明顺序还有一定要求，一般大家都遵循“爱恨原则LVHA”（LoVe HAte），为什么是这个顺序？不能是其它顺序吗？<br>  根据css优先级计算规则，伪类的特殊性值是0,0,1,0，4个伪类的特殊性值相同，那么后面声明的规则优先级高。当鼠标滑过a链接时，满足:link和:hover两个伪类，要改变a标签的颜色，就必须将:hover伪类在:link伪类后面声明；同理，当鼠标点击激活a链接时，同时满足:link、:hover、:active三种状态，要显示a标签激活时的样式（:active），必须将:active声明放到:link和:hover之后。因此得出LVHA这个顺序。这个顺序能不能变？可以，但也只有:link和:visited可以交换位置，因为一个链接要么访问过要么没访问过，不可能同时满足，也就不存在覆盖的问题。</p>
<h1 id="简单的理解方式:">简单的理解方式:</h1><p>标签选择器、伪类及伪对象：优先积分1<br>类选择器、属性选择器：优先积分10<br>ID选择器：优先积分100<br>其他选择器（通配符等）：0<br>根据以上优先积分，统计样式表中出现的每个选择器的个数，再相加，最终得出的分数就是某个选择器的优先级别。</p>
<p>例如：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">p</span> = <span class="number">1</span></div><div class="line"></div><div class="line"><span class="selector-tag">p</span><span class="selector-class">.myColor</span> = <span class="number">1</span>+<span class="number">10</span> = <span class="number">11</span></div><div class="line"></div><div class="line"><span class="selector-class">.myColor</span> = <span class="number">10</span></div><div class="line"></div><div class="line"><span class="selector-id">#myColor</span> = <span class="number">100</span></div></pre></td></tr></table></figure></p>
<p>再次说明：!important关键字 &gt; style属性 &gt; 以上选择器</p>
<blockquote>
<p>前面提到!important属性，!important是用来使IE6和IE7、IE8、火狐(Firefox)、google等浏览器做兼容的，但IE6不能执行!important。当 !important 规则被应用在一个样式声明中时,该样式声明会覆盖CSS中任何其他的声明, 无论它处在声明列表中的哪个位置. 尽管如此, !important规则还是与优先级毫无关系.使用 !important不是一个好习惯，因为它改变了你样式表本来的级联规则，从而难以调试。</p>
</blockquote>
<h1 id="在使用!important时需要注意：">在使用!important时需要注意：</h1><p>Never 永远不要在全站范围的 css 上使用 !important<br>Only 只在需要覆盖全站或外部 css（例如引用的 ExtJs 或者YUI ）的特定页面中使用  !important<br>Never 永远不要在你的插件中使用 !important<br>Always 要优化考虑使用样式规则的优先级来解决问题而不是 !important<br>什么时候应该使用：</p>
<h2 id="A)_一种情况">A) 一种情况</h2><p>  你的网站上有一个设定了全站样式的CSS文件，同时你（或是你同事）写了一些效果通常都是很差的行内样式（行内样式的优先级是最高的）。在这种情况下，你就可以在你全局的CSS文件中写一些!important的样式来覆盖掉那些直接写在元素上的行内样式。</p>
<h2 id="B)_另一种情况">B) 另一种情况</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-id">#someElement</span> <span class="selector-tag">p</span> &#123;  </div><div class="line">    <span class="attribute">color</span>: blue;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="selector-tag">p</span><span class="selector-class">.awesome</span> &#123;  </div><div class="line">    <span class="attribute">color</span>: red;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>  在外层有 #someElement 的情况下，你怎样能使 awesome 的段落变成红色呢？这种情况下，如果不使用!important，第一条规则永远比第二条的优先级更高。</p>
<h2 id="怎样覆盖掉_!important：">怎样覆盖掉 !important：</h2><p>很简单，你只需要再加一条!important 的CSS语句，将其应用到更高优先级的选择器（在原有基础上添加额外的标签、class或id选择器）上；或是保持选择器一样，但添加的位置需要在原有声明的后面（优先级相同的情况下，后边定义的会覆盖前边定义的）。<br>[html] view plain copy print?</p>
<p>#test.a{<br>  color: red !important;     <!--尽管这条声明在前，但是仍会覆盖下边的样式--><br>}<br>a{<br>  color: green !important;<br>}<br>或：<br>[html] view plain copy print?<br>a{<br>  color: green !important;<br>}<br>a{<br>  color: red !important;     <!--同样的选择器，后边的声明会覆盖前边的--><br>}  </p>
<h1 id="link:">link:</h1><p><a href="http://blog.csdn.net/lzgs_4/article/details/43446303" target="_blank" rel="external">http://blog.csdn.net/lzgs_4/article/details/43446303</a></p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                <a class="post-title-link" href="/2016/04/17/css-media/" itemprop="url">
                  Responsive Web Design
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-04-17T22:52:20+08:00" content="2016-04-17">
              2016-04-17
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="允许网页宽度自动调整">允许网页宽度自动调整</h1><p>“自适应网页设计” 到底是怎么做到的？ </p>
<p>首先，在网页代码的头部，加入一行viewport元标签。</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;meta <span class="attr">name="viewport"</span> <span class="attr">content="width=device-width,</span> <span class="attr">initial-scale=1.0,</span> <span class="attr">maximum-scale=1.0,</span> <span class="attr">user-scalable=0"</span> /&gt;</div></pre></td></tr></table></figure>
<blockquote>
<p>width 控制Viewport的宽度,可以指定一个值或者设备的宽度,如device-width为设备的宽度(单位为设备缩放比例1:1的像素),上面代码里设置的宽度是取设备宽度;</p>
<p> initial-scale 原始缩放比例（initial-scale=1）为1.0，即网页初始大小占屏幕面积的100%, 对应的值是一个浮点值,页面呈现大小等于设置原始的宽度乘以initial-scale的值;</p>
<p> maximum-scale 最大缩放,即允许用户缩放的最大比例,也是乘积关系.一般设置为1:1的比例不会让用户缩放的;</p>
<p> minimum-scale 最小缩放,如上;</p>
<p> user-scalable 用户是否可以手动缩放,一般值设为no,不允许用户缩放;</p>
</blockquote>
<p>这段代码的大意是让viewport的物理宽度等于设备的分辨率,不允许用户缩放.原始缩放比例（initial-scale=1）为1.0，即网页初始大小占屏幕面积的100%,所有主流浏览器都支持这个设置，包括IE9。</p>
<h2 id="meta_viewport标签动态改变的方法">meta viewport标签动态改变的方法</h2><h3 id="第一种方法:">第一种方法:</h3><p>可以使用document.write来动态输出meta viewport标签，例如：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">document.<span class="built_in">write</span>('&lt;meta <span class="built_in">name</span>=<span class="string">"viewport"</span> content=<span class="string">"width=device-width,initial-scale=1"</span>&gt;')</div></pre></td></tr></table></figure>
<h3 id="第二种方法:">第二种方法:</h3><p>通过setAttribute来改变</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">id</span>=<span class="string">"testViewport"</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width = 380"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="keyword">var</span> mvp = <span class="built_in">document</span>.getElementById(<span class="string">'testViewport'</span>);</div><div class="line">mvp.setAttribute(<span class="string">'content'</span>,<span class="string">'width=480'</span>);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<h1 id="CSS_@Media查询">CSS @Media查询</h1><p>引用MDN的描述:</p>
<blockquote>
<p> 媒体查询 包含了一个媒体类型和至少一个使用如宽度、高度和颜色等媒体属性来限制样式表范围的表达式。CSS3加入的媒体查询使得无需修改内容便可以使样式应用于某些特定的设备范围。<br>媒体查询包含了一个媒体类型 和如CSS3规范中描述的包含一个或多个表达式的媒体属性，这些媒体属性会被解析成真或假。如果媒体查询中的媒体类型与文档要展示的设备相符则查询结果为真，并且媒体查询中的所有表达式为真。</p>
<h2 id="在stylesheet_Link_选择加载制定的CSS">在stylesheet Link 选择加载制定的CSS</h2></blockquote>
<p>“自适应网页设计”的核心，就是CSS3引入的Media Query模块。<br>它的意思就是，自动探测屏幕宽度，然后加载相应的CSS文件。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">&lt;!-- link元素中的CSS媒体查询 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">media</span>=<span class="string">"(max-width: 800px)"</span> <span class="attr">href</span>=<span class="string">"example.css"</span> /&gt;</span></div></pre></td></tr></table></figure>
<p>上面的代码意思是，如果屏幕宽度不超过800像素（max-width: 800px），就加载example.css文件。</p>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;link rel=<span class="string">"stylesheet"</span> <span class="class"><span class="keyword">type</span></span>=<span class="string">"text/css"</span> media=<span class="string">"screen and (min-width: 400px) and (max-device-width: 600px)"</span> href=<span class="string">"smallScreen.css"</span> /&gt;</div></pre></td></tr></table></figure>
<p>如果屏幕宽度在400像素到600像素之间，则加载smallScreen.css文件。<br>除了用html标签加载CSS文件，还可以在现有CSS文件中使用@import来实现加载。<br>但是并不推荐这样做.</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">　　@<span class="keyword">import</span> url(<span class="string">"tinyScreen.css"</span>) screen and (<span class="built_in">max</span>-device-<span class="built_in">width</span>: <span class="number">400</span>px);</div></pre></td></tr></table></figure>
<p>当媒体查询为真时，相关的样式表或样式规则就会按照正常的级联规则被应用。即使媒体查询返回假， <link> 标签上带有媒体查询的样式表 仍将被下载 （只不过不会被应用）。</p>
<h2 id="在CSS文件内使用@media规则加载不同的CSS">在CSS文件内使用@media规则加载不同的CSS</h2><p>同一个CSS文件中，也可以根据不同的屏幕分辨率，选择应用不同的CSS规则。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">　　@<span class="keyword">media</span> screen and (max-device-width: <span class="number">400px</span>) &#123;</div><div class="line">　　　　<span class="selector-class">.column</span> &#123;</div><div class="line">　　　　　　<span class="attribute">float</span>: none;</div><div class="line">　　　　　　<span class="attribute">width</span>:auto;</div><div class="line">　　　　&#125;</div><div class="line">　　　　<span class="selector-id">#sidebar</span> &#123;</div><div class="line">　　　　　　<span class="attribute">display</span>:none;</div><div class="line">　　　　&#125;</div><div class="line">　　&#125;</div></pre></td></tr></table></figure>
<p>上面的代码意思是，如果屏幕宽度小于400像素，<br>则column块取消浮动（float:none）、宽度自动调节（width:auto），sidebar块不显示（display:none）。</p>
<h2 id="媒体属性">媒体属性</h2><p><em>引用自 MDN</em></p>
<h3 id="媒体查询所有可用的查询方法以及属性">媒体查询所有可用的查询方法以及属性</h3><figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">media_query: [[only | <span class="keyword">not</span>]? &lt;media_type&gt; [ <span class="keyword">and</span> &lt;expression&gt; ]*]</div><div class="line">  | &lt;expression&gt; [ <span class="keyword">and</span> &lt;expression&gt; ]*</div><div class="line">expression: ( &lt;media_feature&gt; [: &lt;value&gt;]? )</div><div class="line"></div><div class="line">&lt;!-- 在不使用 <span class="keyword">not</span> 或 only 操作符的情况下，媒体类型(media type)是可选的，如果没有设置则默认为 all 。 --&gt;</div><div class="line"></div><div class="line">media_type: all | aural | braille | handheld | <span class="built_in">print</span> |</div><div class="line">  projection | screen | tty | tv | embossed</div><div class="line"></div><div class="line">media_feature: <span class="built_in">width</span> | <span class="built_in">min</span>-<span class="built_in">width</span> | <span class="built_in">max</span>-<span class="built_in">width</span></div><div class="line">  | <span class="built_in">height</span> | <span class="built_in">min</span>-<span class="built_in">height</span> | <span class="built_in">max</span>-<span class="built_in">height</span></div><div class="line">  | device-<span class="built_in">width</span> | <span class="built_in">min</span>-device-<span class="built_in">width</span> | <span class="built_in">max</span>-device-<span class="built_in">width</span></div><div class="line">  | device-<span class="built_in">height</span> | <span class="built_in">min</span>-device-<span class="built_in">height</span> | <span class="built_in">max</span>-device-<span class="built_in">height</span></div><div class="line">  | aspect-ratio | <span class="built_in">min</span>-aspect-ratio | <span class="built_in">max</span>-aspect-ratio</div><div class="line">  | device-aspect-ratio | <span class="built_in">min</span>-device-aspect-ratio | <span class="built_in">max</span>-device-aspect-ratio</div><div class="line">  | <span class="built_in">color</span> | <span class="built_in">min</span>-<span class="built_in">color</span> | <span class="built_in">max</span>-<span class="built_in">color</span></div><div class="line">  | <span class="built_in">color</span>-index | <span class="built_in">min</span>-<span class="built_in">color</span>-index | <span class="built_in">max</span>-<span class="built_in">color</span>-index</div><div class="line">  | monochrome | <span class="built_in">min</span>-monochrome | <span class="built_in">max</span>-monochrome</div><div class="line">  | <span class="built_in">resolution</span> | <span class="built_in">min</span>-<span class="built_in">resolution</span> | <span class="built_in">max</span>-<span class="built_in">resolution</span></div><div class="line">  | scan | <span class="built_in">grid</span></div></pre></td></tr></table></figure>
<p>大多数媒体属性带有“min-”和“max-”前缀，用于表达“小于等于”和“大于等于”。这避免了使用与HTML和XML冲突的“&lt;”和“&gt;”字符。如果你未向媒体属性指定一个值，并且该特性的实际值不为零，则该表达式被解析为真。</p>
<p>注意：如果浏览器运行的设备上没有该属性值，包含这个属性值的表达式一般返回假。例如，在语音合成器上查询屏幕长宽比总是返回假。</p>
<h3 id="颜色（color）">颜色（color）</h3><p>指定输出设备每个像素单元的比特值。如果设备不支持输出颜色，则该值为0。\</p>
<p>值： <color><br>媒体： visual<br>是否接受 min/max 前缀：是</color></p>
<p>注意：如果每个颜色单元具有不同数量的比特值，则使用最小的。例如，如果显示器为蓝色和红色提供5比特，而为绿色提供6比特，则认为每个颜色单元有5比特。如果设备使用索引颜色，则使用颜色表中颜色单元的最小比特数。</p>
<h4 id="示例">示例</h4><p>向所有能显示颜色的设备应用样式表：</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@media <span class="literal">all</span> <span class="literal">and</span> (color) &#123; <span class="params">...</span> &#125;</div></pre></td></tr></table></figure>
<p>向每个颜色单元至少有4个比特的设备应用样式表：</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@media <span class="literal">all</span> <span class="literal">and</span> (<span class="keyword">min</span><span class="params">-color</span>: <span class="number">4</span>) &#123; <span class="params">...</span> &#125;</div></pre></td></tr></table></figure>
<h3 id="颜色索引（color-index）">颜色索引（color-index）</h3><p>指定了输出设备中颜色查询表中的条目数量。</p>
<p>值：<integer><br>媒体： visual<br>是否接受 min/max 前缀：是</integer></p>
<h4 id="示例-1">示例</h4><p>向所有使用索引颜色的设备应用样式表，你可以这么做：</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@media <span class="literal">all</span> <span class="literal">and</span> (color<span class="params">-index</span>) &#123; <span class="params">...</span> &#125;</div></pre></td></tr></table></figure>
<p>向所有使用至少256个索引颜色的设备应用样式表：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">media</span>=<span class="string">"all and (min-color-index: 256)"</span> <span class="attr">href</span>=<span class="string">"http://foo.bar.com/stylesheet.css"</span> /&gt;</span></div></pre></td></tr></table></figure>
<h3 id="宽高比（aspect-ratio）">宽高比（aspect-ratio）</h3><p>描述了输出设备目标显示区域的宽高比。该值包含两个以“/”分隔的正整数。代表了水平像素数（第一个值）与垂直像素数（第二个值）的比例。</p>
<p>值：<ratio><br>媒体： visual, tactile<br>是否接受 min/max 前缀：是</ratio></p>
<h4 id="示例-2">示例</h4><p>下面为显示区域宽高至少为一比一的设备选择了一个特殊的样式表。</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@media screen <span class="literal">and</span> (<span class="keyword">min</span><span class="params">-aspect</span><span class="params">-ratio</span>: <span class="number">1</span>/<span class="number">1</span>) &#123; <span class="params">...</span> &#125;</div></pre></td></tr></table></figure>
<p>这指定了宽高比或者1：1或者更大。换句话说，可视区域或者是正方形或者是宽屏。</p>
<h3 id="设备宽高比（device-aspect-ratio）">设备宽高比（device-aspect-ratio）</h3><p>描述了输出设备的宽高比。该值包含两个以“/”分隔的正整数。代表了水平像素数（第一个值）与垂直像素数（第二个值）的比例。</p>
<p>值：<ratio><br>媒体：visual, tactile<br>是否接受 min/max 前缀：是</ratio></p>
<h4 id="示例-3">示例</h4><p>下面为宽屏设备选择了一个特殊的样式表。<br><figure class="highlight hsp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@media <span class="keyword">screen</span> <span class="keyword">and</span> (device-aspect-ratio: <span class="number">16</span>/<span class="number">9</span>), <span class="keyword">screen</span> <span class="keyword">and</span> (device-aspect-ratio: <span class="number">16</span>/<span class="number">10</span>) &#123; ... &#125;</div></pre></td></tr></table></figure></p>
<p>宽高比或者16：9或者16：10。</p>
<h3 id="设备高度（device-height）">设备高度（device-height）</h3><p>描述了输出设备的高度（整个屏幕或页的高度，而不是仅仅像文档窗口一样的渲染区域）。</p>
<p>值：<length><br>媒体：visual, tactile<br>是否接受 min/max 前缀：是</length></p>
<h4 id="示例-4">示例</h4><p>向显示在最大宽度800px的屏幕上的文档应用样式表，你可以这样做：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">media</span>=<span class="string">"screen and (max-device-width: 799px)"</span> /&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="设备宽度（device-width）">设备宽度（device-width）</h3><p>描述了输出设备的宽度（整个屏幕或页的高度，而不是仅仅像文档窗口一样的渲染区域）。</p>
<p>值：<length><br>媒体： visual, tactile<br>是否接受 min/max 前缀：是</length></p>
<h3 id="网格（grid）">网格（grid）</h3><p>判断输出设备是网格设备还是位图设备。如果设备是基于网格的（例如电传打字机终端或只能显示一种字形的电话），该值为1，否则为0。</p>
<p>值：<integer><br>媒体：all<br>是否接受 min/max 前缀： 否</integer></p>
<h4 id="示例-5">示例</h4><p>向一个15字符宽度或更窄的手持设备应用样式：<br><figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@media handheld <span class="literal">and</span> (grid) <span class="literal">and</span> (<span class="keyword">max</span><span class="params">-width</span>: <span class="number">15</span>em) &#123; <span class="params">...</span> &#125;</div></pre></td></tr></table></figure></p>
<p>注意：“em” 在网格设备中有不同的意义；一个“em”的实际宽度不得而知，假设1em相当于一个网格单元的宽高。</p>
<h3 id="高度（height）">高度（height）</h3><p>height 媒体属性描述了输出设备渲染区域（如可视区域的高度或打印机纸盒的高度）的高度。</p>
<p>值：<length><br>媒体：visual, tactile<br>是否接受 min/max 前缀：是</length></p>
<p>注意：用户调整窗口大小后，火狐浏览器会根据使用了width和height属性的媒体查询来切换合适的样式表。</p>
<h3 id="方向（orientation）">方向（orientation）</h3><p>指定了设备处于横屏（宽度大于宽度）模式还是竖屏（高度大于宽度）模式。</p>
<p>值：landscape | portrait<br>媒体：visual<br>是否接受 min/max 前缀：否</p>
<h4 id="示例-6">示例</h4><p>向竖屏设备应用样式表：</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@media <span class="literal">all</span> <span class="literal">and</span> (orientation: portrait) &#123; <span class="params">...</span> &#125;</div></pre></td></tr></table></figure>
<h3 id="分辨率（resolution）">分辨率（resolution）</h3><p>指定输出设备的分辨率（像素密度）。分辨率可以用每英寸（dpi）或每厘米（dpcm）的点数来表示。</p>
<p>值： <resolution><br>媒体： bitmap<br>是否接受 min/max 前缀：是</resolution></p>
<h4 id="示例-7">示例</h4><p>为每英寸至多300点的打印机应用样式：<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@media <span class="built_in">print</span> <span class="keyword">and</span> (min-resolution: <span class="number">300</span>dpi) &#123; ... &#125;</div></pre></td></tr></table></figure></p>
<p>替换老旧的 (min-device-pixel-ratio: 2) 语法：<br><figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@media screen <span class="literal">and</span> (<span class="keyword">min</span><span class="params">-resolution</span>: <span class="number">2</span>dppx) &#123; <span class="params">...</span> &#125;</div></pre></td></tr></table></figure></p>
<h3 id="扫描（scan）">扫描（scan）</h3><p>描述了电视输出设备的扫描过程。</p>
<p>值： progressive | interlace<br>媒体：tv<br>是否接受 min/max 前缀：否</p>
<p>示例</p>
<p>向以顺序方式扫描的电视机上应用样式表：<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@media</span> <span class="function">tv <span class="title">and</span> <span class="params">(scan: progressive)</span> </span>&#123; ... &#125;</div></pre></td></tr></table></figure></p>
<h3 id="宽度（width）">宽度（width）</h3><p>width 媒体属性描述了输出设备渲染区域（如可视区域的宽度或打印机纸盒的宽度）的宽度。</p>
<p>值： <length><br>媒体： visual, tactile<br>是否接受 min/max 前缀：是</length></p>
<p>注意：用户调整窗口大小后，火狐浏览器会根据使用了width和height属性的媒体查询来切换合适的样式表。<br>示例</p>
<p>如果你想向最小宽度20em的手持设备或屏幕应用样式表，你可以使用这样的查询：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@media handheld <span class="built_in">and</span> (<span class="built_in">min</span>-width: <span class="number">20</span><span class="keyword">em</span>), screen <span class="built_in">and</span> (<span class="built_in">min</span>-width: <span class="number">20</span><span class="keyword">em</span>) &#123; ... &#125;</div></pre></td></tr></table></figure>
<p>这个媒体查询将向最小宽度8.5英寸的打印机应用样式表：</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;link <span class="attr">rel="stylesheet"</span> <span class="attr">media="print</span> <span class="literal">and</span> (min-width: <span class="number">8.5</span><span class="keyword">in</span>)<span class="string">"</span></div><div class="line">    href="http://foo.com/mystyle.css<span class="string">" /&gt;</span></div></pre></td></tr></table></figure>
<p>这个查询适用于宽度在500px和800px之间的屏幕：</p>
<figure class="highlight hsp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@media <span class="keyword">screen</span> <span class="keyword">and</span> (min-<span class="keyword">width</span>: <span class="number">500</span>px) <span class="keyword">and</span> (max-<span class="keyword">width</span>: <span class="number">800</span>px) &#123; ... &#125;</div></pre></td></tr></table></figure>
<h2 id="更多的例子">更多的例子</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> </div><div class="line">@<span class="keyword">media</span> screen and (max-width: <span class="number">1000px</span>) and (min-width: <span class="number">700px</span>) &#123;</div><div class="line">    <span class="selector-tag">ul</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span><span class="selector-pseudo">:before</span> &#123;</div><div class="line">        <span class="attribute">content</span>: <span class="string">"Email: "</span>;</div><div class="line">        <span class="attribute">font-style</span>: italic;</div><div class="line">        <span class="attribute">color</span>: <span class="number">#666666</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面的这段代码的意思是:当屏幕的宽度是在700到1000之间的时候,我们会在Email连接之前用Css 添加一个Email的文字以及设置斜体和颜色.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* For mobile phones: */</span></div><div class="line"><span class="selector-attr">[class*="col-"]</span> &#123;</div><div class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</div><div class="line">&#125;</div><div class="line">@<span class="keyword">media</span> only screen and (min-width: <span class="number">768px</span>) &#123;</div><div class="line">    <span class="comment">/* For desktop: */</span></div><div class="line">    <span class="selector-class">.col-1</span> &#123;<span class="attribute">width</span>: <span class="number">8.33%</span>;&#125;</div><div class="line">    <span class="selector-class">.col-2</span> &#123;<span class="attribute">width</span>: <span class="number">16.66%</span>;&#125;</div><div class="line">    <span class="selector-class">.col-3</span> &#123;<span class="attribute">width</span>: <span class="number">25%</span>;&#125;</div><div class="line">    <span class="selector-class">.col-4</span> &#123;<span class="attribute">width</span>: <span class="number">33.33%</span>;&#125;</div><div class="line">    <span class="selector-class">.col-5</span> &#123;<span class="attribute">width</span>: <span class="number">41.66%</span>;&#125;</div><div class="line">    <span class="selector-class">.col-6</span> &#123;<span class="attribute">width</span>: <span class="number">50%</span>;&#125;</div><div class="line">    <span class="selector-class">.col-7</span> &#123;<span class="attribute">width</span>: <span class="number">58.33%</span>;&#125;</div><div class="line">    <span class="selector-class">.col-8</span> &#123;<span class="attribute">width</span>: <span class="number">66.66%</span>;&#125;</div><div class="line">    <span class="selector-class">.col-9</span> &#123;<span class="attribute">width</span>: <span class="number">75%</span>;&#125;</div><div class="line">    <span class="selector-class">.col-10</span> &#123;<span class="attribute">width</span>: <span class="number">83.33%</span>;&#125;</div><div class="line">    <span class="selector-class">.col-11</span> &#123;<span class="attribute">width</span>: <span class="number">91.66%</span>;&#125;</div><div class="line">    <span class="selector-class">.col-12</span> &#123;<span class="attribute">width</span>: <span class="number">100%</span>;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面的这段代码的意思是: 默认情况下是为手机做的宽度适配(即所有的宽度都是100%),当只有屏幕的宽度大于768像素的时候,才会单独给各个col设置宽度的值. </p>
<h1 id="当页面为自适应页面时,实现图片自适应的奇妙的解决方法:">当页面为自适应页面时,实现图片自适应的奇妙的解决方法:</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- HTML: --&gt;</span></div><div class="line"> <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"image-container"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"xxx.png"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- CSS: --&gt;</span></div><div class="line">p.image-container &#123;</div><div class="line">  width: 100%;</div><div class="line">  height: 0;</div><div class="line">  padding-bottom: 60%;</div><div class="line">  overflow: hidden;</div><div class="line">&#125;</div><div class="line"></div><div class="line">p.image-container img &#123;</div><div class="line">  width: 100%;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="思路:">思路:</h2><p><em>原作者: zihua-li</em></p>
<blockquote>
<p>需求:在保持 item 元素宽高比恒定（如高是宽的 1.618 倍）的情况下，使得 item 元素可以和父元素同比缩放。 </p>
</blockquote>
<p>我们知道，如果当 item 元素是图片，同时需要保持的宽高比恰好为图片本身的宽高比时，<br>可以设置 item 的 height 为 auto 即可轻松实现这个需求。<br>然而当 item 元素不是图片或者要保持的宽高比和图片本身的宽高比不同时，这个需求显得很难直接用 CSS 实现。<br>为此我放弃 CSS，直接用 JavaScript 绑定 window 的 onresize 事件来动态获取每个 item 的宽度，从而计算并设置其高度。<br>我一直在使用这个解决方案，直到今天调整样式时，突然想到这个需求竟然是可以只使用 CSS 解决的。<br>首先需要知道，一个元素的 padding，如果值是一个百分比，那这个百分比是相对于其父元素的宽度而言的，即使对于 padding-bottom 和 padding-top 也是如此。<br>另外，在计算 Overflow 时，是将元素的内容区域（即 width / height 对应的区域）和 Padding 区域一起计算的。换句话说，即使将元素的 overflow 设置为 hidden，“溢出”到 Padding 区域的内容也会照常显示。<br>综上两条所述，我们可以使用 padding-bottom 来代替 height 来实现高度与宽度成比例的效果。因为 item 元素的宽度是其父元素宽度的 21%，所以我们将 padding-bottom 设置为它的 1.618 倍，即 33.98%。同时将其 height 设置为 0 以使元素的“高度”等于 padding-bottom 的值，从而实现需要的效果。<br>最后 item 元素的 CSS 样式为：</p>
<p>.item {<br>  float: left;<br>  margin: 10px 5%;<br>  padding-bottom: 33.98%;<br>  width: 21%;<br>  height: 0;<br>}<br>页面效果见 <a href="http://jsfiddle.net/luin/25BbH/7/，拖动窗口调整页面宽度，item" target="_blank" rel="external">http://jsfiddle.net/luin/25BbH/7/，拖动窗口调整页面宽度，item</a> 元素始终保持恒定的宽高比。</p>
<h1 id="兼容情况:">兼容情况:</h1><h2 id="@media_screen_属性的浏览器支持情况">@media screen 属性的浏览器支持情况</h2><p><img src="http://7xnuw0.com1.z0.glb.clouddn.com/16-4-17/99373677.jpg" alt=""></p>
<h2 id="@media_width_属性浏览器的支持情况">@media width 属性浏览器的支持情况</h2><p><img src="http://7xnuw0.com1.z0.glb.clouddn.com/16-4-17/7417540.jpg" alt=""></p>
<h2 id="@Media_Queries支持情况">@Media Queries支持情况</h2><p><img src="http://7xnuw0.com1.z0.glb.clouddn.com/16-4-18/50675002.jpg" alt=""></p>
<h1 id="Ref:">Ref:</h1><p><a href="http://www.ruanyifeng.com/blog/2012/05/responsive_web_design.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2012/05/responsive_web_design.html</a> -阮一峰<br><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media#Examples" target="_blank" rel="external">https://developer.mozilla.org/en-US/docs/Web/CSS/@media#Examples</a> -MDN<br><a href="http://zihua.li/2013/12/keep-height-relevant-to-width-using-css/" target="_blank" rel="external">http://zihua.li/2013/12/keep-height-relevant-to-width-using-css/</a> -zihuali</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                <a class="post-title-link" href="/2016/04/10/js-single-thread-concepts/" itemprop="url">
                  JavaScript的单线程运行机制笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-04-10T23:17:24+08:00" content="2016-04-10">
              2016-04-10
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="javascript_是单线程运行的么?">javascript 是单线程运行的么?</h1><p>JavaScript引擎是单线程运行的,浏览器无论在什么时候都只且只有一个线程在运行JavaScript程序。 </p>
<blockquote>
<p>为什么JavaScript不能有多个线程呢？这样能提高效率啊！</p>
<p>JavaScript的单线程，与它的用途有关。作为浏览器脚本语言，JavaScript的主要用途是与用户互动，以及操作DOM。这决定了它只能是单线程，否则会带来很复杂的同步问题。比如，假定JavaScript同时有两个线程，一个线程在某个DOM节点上添加内容，另一个线程删除了这个节点，这时浏览器应该以哪个线程为准？</p>
<p>所以，为了避免复杂性，从一诞生，JavaScript就是单线程，这已经成了这门语言的核心特征，将来也不会改变。</p>
<p>为了利用多核CPU的计算能力，HTML5提出Web Worker标准，允许JavaScript脚本创建多个线程，但是子线程完全受主线程控制，且不得操作DOM。所以，这个新标准并没有改变JavaScript单线程的本质。</p>
</blockquote>
<h2 id="代码验证：js是单线程运行的">代码验证：js是单线程运行的</h2><p>下面的代码，当while执行时候，setTimeout永远不会执行。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> isEnd = <span class="literal">true</span>;</div><div class="line">     <span class="built_in">window</span>.setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">         isEnd = <span class="literal">false</span>;<span class="comment">//1s后，改变isEnd的值</span></div><div class="line">     &#125;, <span class="number">1000</span>);</div><div class="line">     <span class="comment">//这个while永远的占用了js线程，所以setTimeout里面的函数永远不会执行</span></div><div class="line">     <span class="keyword">while</span> (isEnd);</div><div class="line">     <span class="comment">//alert也永远不会弹出</span></div><div class="line">     alert(<span class="string">'end'</span>);</div></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'开始运行js'</span>);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">func01</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'function 1 正在运行'</span>);</div><div class="line">	<span class="keyword">return</span> func02();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">func02</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="built_in">console</span>.log(<span class="string">'function 2 正在运行'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'mainJs 开始运行'</span>);</div><div class="line">	  func01();</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'mainJs 运行结束'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">main();</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'js运行结束'</span>);</div></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">开始运行js</div><div class="line">mainJs 开始运行</div><div class="line"><span class="keyword">function</span> <span class="title">1</span> 正在运行</div><div class="line"><span class="keyword">function</span> <span class="title">2</span> 正在运行</div><div class="line">mainJs 运行结束</div><div class="line">js运行结束</div></pre></td></tr></table></figure>
<h1 id="执行栈的队列">执行栈的队列</h1><blockquote>
<p>单线程就意味着，所有任务需要排队，前一个任务结束，才会执行后一个任务。如果前一个任务耗时很长，后一个任务就不得不一直等着。<br>如果排队是因为计算量大，CPU忙不过来，倒也算了，但是很多时候CPU是闲着的，因为IO设备（输入输出设备）很慢（比如Ajax操作从网络读取数据），不得不等着结果出来，再往下执行。</p>
<p>JavaScript语言的设计者意识到，这时主线程完全可以不管IO设备，挂起处于等待中的任务，先运行排在后面的任务。等到IO设备返回了结果，再回过头，把挂起的任务继续执行下去。</p>
<p>于是，所有任务可以分成两种，一种是同步任务（synchronous），另一种是异步任务（asynchronous）。同步任务指的是，在主线程上排队执行的任务，只有前一个任务执行完毕，才能执行后一个任务；异步任务指的是，不进入主线程、而进入”任务队列”（task queue）的任务，只有”任务队列”通知主线程，某个异步任务可以执行了，该任务才会进入主线程执行。<br>具体来说，异步执行的运行机制如下。（同步执行也是如此，因为它可以被视为没有异步任务的异步执行。）</p>
</blockquote>
<p>Ps：</p>
<ol>
<li>执行栈队列是fist in  last out 的数据结构。</li>
<li>回调函数队列是firtst in first out 的数据结构。</li>
</ol>
<p><img src="http://7xnuw0.com1.z0.glb.clouddn.com/16-4-10/32375570.jpg" alt=""></p>
<p>运行时的流程图应该是这样：</p>
<p><img src="http://7xnuw0.com1.z0.glb.clouddn.com/16-4-11/59788839.jpg" alt=""></p>
<blockquote>
<ol>
<li>所有同步任务都在主线程上执行，形成一个执行栈（execution context stack）。</li>
<li>主线程之外，还存在一个”任务队列”（task queue）。只要异步任务有了运行结果，就在”任务队列”之中放置一个事件。</li>
<li>一旦”执行栈”中的所有同步任务执行完毕，系统就会读取”任务队列”，看看里面有哪些事件。那些对应的异步任务，于是结束等待状态，进入执行栈，开始执行。</li>
<li>主线程不断重复上面的第三步。</li>
</ol>
</blockquote>
<p>Ps: Promise，mutation，observer的回调函数属于特殊的任务会在当前的eventLoop末尾执行，而普通任务则是在下一次获取任务队列后运行。</p>
<h2 id="验证回调函数会进入回调函数队列等待执行栈空闲后再调用：">验证回调函数会进入回调函数队列等待执行栈空闲后再调用：</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'01 开始运行js'</span>);</div><div class="line"></div><div class="line">setTimeout( <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log(<span class="string">'02 , 我从eventloop 中被加到了回调函数队列等待运行 等待stack空闲了以后才会调用我'</span>);</div><div class="line">&#125;,<span class="number">5000</span> );</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'03, 这个写在setTimeout 后面'</span>);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'现在stack 队列里是空的, 因为没有定义返回值所以会返回 undefined  '</span>);</div></pre></td></tr></table></figure>
<h2 id="运行结果：">运行结果：</h2><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="number">01</span> 开始运行js</div><div class="line"><span class="number">03</span>, 这个写在setTimeout 后面</div><div class="line">现在stack 队列里是空的, 因为没有定义返回值所以会返回 undefined </div><div class="line">undefined</div><div class="line"><span class="number">02</span> , 我从eventloop 中被加到了回调函数队列等待运行 等待stack空闲了以后才会调用我</div></pre></td></tr></table></figure>
<h1 id="回调函数队列与事件循环机制:">回调函数队列与事件循环机制:</h1><p><img src="http://7xnuw0.com1.z0.glb.clouddn.com/16-4-10/97771921.jpg" alt=""></p>
<blockquote>
<p>浏览器的内核是多线程的，它们在内核控制下相互配合以保持同步，一个浏览器至少实现三个常驻线程：JavaScript引擎线程，GUI渲染线程，浏览器事件触发线程（图中的WebAPIs）。 </p>
<p>JavaScript引擎是基于事件驱动单线程执行的，JavaScript引擎一直等待着任务队列中任务的到来，然后加以处理，浏览器无论什么时候都只有一个JavaScript线程在运行JavaScript程序。 </p>
<p>GUI渲染线程负责渲染浏览器界面，当界面需要重绘（Repaint）或由于某种操作引发回流(Reflow)时,该线程就会执行。但需要注意，GUI渲染线程与JavaScript引擎是互斥的，当JavaScript引擎执行时GUI线程会被挂起，GUI更新会被保存在一个队列中等到JavaScript引擎空闲时立即被执行。<br>事件触发线程，当一个事件被触发时该线程会把事件添加到待处理队列的队尾，等待JavaScript引擎的处理。这些事件可来自JavaScript引擎当前执行的代码块如setTimeout、也可来自浏览器内核的其他线程如鼠标点击、Ajax异步请求等，但由于JavaScript的单线程关系所有这些事件都得排队等待JavaScript引擎处理（当线程中没有执行任何同步代码的前提下才会执行异步代码）。 </p>
</blockquote>
<h1 id="用for循环堵塞执行栈来测试事件被添加到eventLoop的时机">用for循环堵塞执行栈来测试事件被添加到eventLoop的时机</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'1 js 开始运行'</span>); </div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'a'</span>);</div><div class="line">&#125;, <span class="number">10</span>);  </div><div class="line"></div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'b'</span>);</div><div class="line">&#125;, <span class="number">0</span>);  </div><div class="line"></div><div class="line"><span class="keyword">var</span> sum = <span class="number">0</span>;  <span class="built_in">console</span>.time(<span class="string">'loopCost'</span>);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i ++) &#123;  </div><div class="line">    sum += i;  </div><div class="line">&#125;   </div><div class="line"><span class="built_in">console</span>.log(<span class="string">'for 循环结果：'</span>,sum);  </div><div class="line"></div><div class="line"><span class="built_in">console</span>.timeEnd(<span class="string">'loopCost'</span>);</div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'c'</span>);</div><div class="line">&#125;, <span class="number">0</span>);</div></pre></td></tr></table></figure>
<h2 id="运行结果：-1">运行结果：</h2><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> <span class="keyword">js </span>开始运行</div><div class="line"><span class="number">4950</span></div><div class="line"><span class="symbol">loopCost:</span> <span class="number">0</span>.<span class="number">298</span>ms</div><div class="line"></div><div class="line"><span class="keyword">b</span></div><div class="line">c</div><div class="line">a</div></pre></td></tr></table></figure>
<p>因为b和c的等待时间是0，所以第一时间被加入到回调事件的队尾等待主函数空闲时再进行调用.<br>而a事件则需要等待10ms以后才被加入回调事件队列的队尾等待调用.</p>
<h1 id="增加for循环运行时间">增加for循环运行时间</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'1 js 开始运行'</span>); </div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'a'</span>);</div><div class="line">&#125;, <span class="number">10</span>);  </div><div class="line"></div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'b'</span>);</div><div class="line">&#125;, <span class="number">0</span>);  </div><div class="line"></div><div class="line"><span class="keyword">var</span> sum = <span class="number">0</span>;  <span class="built_in">console</span>.time(<span class="string">'loopCost'</span>);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i ++) &#123;  </div><div class="line">    sum += i;  </div><div class="line">&#125;   </div><div class="line"><span class="built_in">console</span>.log(<span class="string">'for 循环结果：'</span>,sum);  </div><div class="line"></div><div class="line"><span class="built_in">console</span>.timeEnd(<span class="string">'loopCost'</span>);</div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'c'</span>);</div><div class="line">&#125;, <span class="number">0</span>);</div></pre></td></tr></table></figure>
<h2 id="运行结果：-2">运行结果：</h2><p>当for循环的运行时间超过10ms的情况下,当for 循环完成的时候, a的回调函数会比c的回调函数先触发,然后被加入回调函数等待队列里,等待事件循环取出执行。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> js 开始运行</div><div class="line"><span class="keyword">for</span> 循环结果： <span class="number">49995000</span></div><div class="line">loopCost: <span class="number">13.285ms</span></div><div class="line"> <span class="selector-tag">b</span></div><div class="line"> <span class="selector-tag">a</span></div><div class="line"> c</div></pre></td></tr></table></figure>
<h1 id="浏览器异步请求数量的验证">浏览器异步请求数量的验证</h1><p>通过上面的验证,我们得知js是单线程运行的,那浏览器的辅助线程对js的异步请求有限制么?<br>最大支持同时发起多少个请求呢?</p>
<p>通过查找资料可以得知:</p>
<blockquote>
<p>浏览器与同一服务器的连接数最大值有限制，即Chrome和Firefox为6，IE为12。<br>在Firefox的“about:config”页面下找到如下图的配置项（network.http.max-persistent-connections-per-server）</p>
</blockquote>
<p>但还是通过代码来验证最靠谱:.<br>下面我们来进行验证:</p>
<h2 id="代码验证:">代码验证:</h2><h3 id="HTML以及Ajax_请求页面:">HTML以及Ajax 请求页面:</h3><p>html页面在点击事件触发时会同时发起20个AJAX异步请求.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"> <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"requestNum"</span>&gt;</span>请求数：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"requestNum"</span> <span class="attr">value</span>=<span class="string">"20"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"startRequest()"</span>&gt;</span>开始请求<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">config</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="built_in">window</span>.XMLHttpRequest();</div><div class="line">    <span class="comment">//console.log(config.url);</span></div><div class="line">    xhr.open(<span class="string">"GET"</span>, config.url, <span class="literal">true</span> );</div><div class="line">    xhr.send(<span class="literal">null</span>);</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">startRequest</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> num = ~~requestNum.value;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; num; i += <span class="number">1</span>) &#123;</div><div class="line">        <span class="built_in">console</span>.log(i);</div><div class="line">        ajax(&#123;</div><div class="line">            <span class="attr">url</span>: <span class="string">"http://127.0.0.1:1337/?="</span> + i</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="Node-js_服务器端的代码">Node.js 服务器端的代码</h3><p>这里我们创建了一个Http 服务器,在接收到请求以后设置一个timeout,在一秒以后才结束返回请求.<br>并且会在接收到请求的同时,记录下时间.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</div><div class="line"></div><div class="line">http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(req.url);</div><div class="line">    <span class="keyword">var</span> startTime = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'第 次接收到请求 时间是 ：'</span>,startTime);</div><div class="line">    res.writeHead(<span class="number">200</span>, &#123;</div><div class="line">        <span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span>,</div><div class="line">        <span class="string">'Access-Control-Allow-Origin'</span>: <span class="string">'*'</span>,</div><div class="line">        <span class="string">'charset'</span>: <span class="string">'utf8'</span></div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        res.end(<span class="built_in">String</span>(+<span class="keyword">new</span> <span class="built_in">Date</span>));</div><div class="line">    &#125;, <span class="number">1000</span>);</div><div class="line">   </div><div class="line">&#125;).listen(<span class="number">1337</span>, <span class="string">'127.0.0.1'</span>);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'Server running at http://127.0.0.1:1337/'</span>);</div></pre></td></tr></table></figure>
<h3 id="运行结果:">运行结果:</h3><p>监控发起的网络请求时间:</p>
<p><img src="http://7xnuw0.com1.z0.glb.clouddn.com/16-4-17/48064341.jpg" alt=""></p>
<p>服务器端的log日志:<br>我们可以看得出来在同一时间节点,请求都是6个为一组接收到的.<br><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">/?=<span class="number">0</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">05</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">1</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">05</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">2</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">05</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">3</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">05</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">4</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">05</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">5</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">05</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">6</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">06</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">7</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">06</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">8</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">06</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">9</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">06</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">10</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">06</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">11</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">06</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">12</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">07</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">13</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">07</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">14</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">07</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">15</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">07</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">16</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">07</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">17</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">07</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">18</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">08</span> GMT+<span class="number">0800</span> (CST)</div><div class="line">/?=<span class="number">19</span></div><div class="line">这次接收到请求 时间是 ： Sun Apr <span class="number">17 2016 22</span>:<span class="number">29</span>:<span class="number">08</span> GMT+<span class="number">0800</span> (CST)</div></pre></td></tr></table></figure></p>
<p>参考链接：<br><a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2014/10/event-loop.html</a> －阮一峰</p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                <a class="post-title-link" href="/2016/03/18/JS-execution-context/" itemprop="url">
                  Javascript 中的 运行环境(Execution Context),  作用域链(Scope Chain), this & 闭包(Closure)概念
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-03-18T09:31:55+08:00" content="2016-03-18">
              2016-03-18
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>在JS中想要真正搞明白Closure(闭包)这个概念,必须先要把Execution Context,Scope Chain和this这三个概念搞清楚.</p>
<h1 id="运行环境(Execution_Context)">运行环境(Execution Context)</h1><p>在 ECMA 262 3rd edition中: Execution Context决定了在执行栈中运行的代码所能访问的变量,函数.很多人总是把这个概念和作用域链混淆,而实际上作用域链ScopeChain只是Execution Context的一部分.</p>
<ul>
<li><p>可以暂时简单地理解为能在执行栈中独立完整运行的代码,它由三个部分的内容组成:</p>
<ul>
<li>作用域链(Scope Chain) </li>
<li>变量对象(Variable Object) </li>
<li>Execution Context的this指针.</li>
</ul>
</li>
<li><p>下面三种情况都会生成一个新的Execution Context:</p>
<ul>
<li>初始化全局环境时</li>
<li>声明一个函数时</li>
<li>执行Eval()时</li>
</ul>
</li>
</ul>
<h2 id="作用域链(scope_Chain)">作用域链(scope Chain)</h2><p>当声明一个function时,就会自动生成的这个function的<code>[[scope]]</code>属性.<code>[[scope]</code>]会把当前Execution Context的 AO或VO添加到function<code>[[scope]]</code>属性的最前端(也就是作用域链的最前端).所以内部的[[scope]]是如何被定义的对于我们理解Execution Conetext来说很重要.</p>
<p>在 ECMAScript 中所定义的函数都可以看成是object对象,他们是在从实例化代码中声明的函数,执行函数表达式或者调用构造函数的时候中被创建的.这里分成两种情况:</p>
<ul>
<li><p>当调用构造函数创建实例对象时. 构造函数中会包含一个[[scope]]属性指向一个只包含了全局对象(global object)的作用域链(scope chain).</p>
</li>
<li><p>当函数对象是被函数声明或函数表达式创建的,会创建一个函数内部的<code>[[scope]]</code>属性,<br>函数内部的<code>[[scope]]</code> 指向全局对象的<code>[[scope]]</code>属性, 最后形成一个作用域链(scope chain).</p>
</li>
</ul>
<p>最简单的一个例子,在全局环境下声明一个函数:</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">exampleFunc</span><span class="params">(formalParameter)</span></span>&#123;</div><div class="line">    ...   <span class="comment">// 函数体 function body code</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>在全局执行环境声明变量的时候会生成相关联的函数对象,全局执行环境包含一个简单的scopeChain,指向的就是全局对象(global object 作为VO使用).</li>
<li>因此在创建的函数对象时(就是在<code>global object</code>中创建一个名字为<code>exampleFunc</code>的方法属性时),函数对象实例的<code>[[scope]]</code>内部属性会指向一个只包含<code>global object</code>的作用域链. </li>
<li>当像下面的函数表达式在一个全局的execution context中执行的时候,也会分配一个类似的作用域链.</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> exampleFuncRef = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</div><div class="line">    ...   <span class="comment">// 函数体 function body code</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在一个函数内部函数声明或函数表达式会使新建的内部函数的<code>[[scope]]</code>属性指向外部部函数的<code>execution context</code>.</p>
<p>参考以下代码:</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">outerFunc</span><span class="params">(formalParameter)</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">innerFunc</span><span class="params">()</span></span>&#123;</div><div class="line">        ... <span class="comment">// innerfunc的函数体 </span></div><div class="line">    &#125;</div><div class="line">    ...  <span class="comment">// outerFunc的函数体 the rest of the outer function body.</span></div><div class="line">&#125;</div><div class="line">outerFunc( <span class="number">5</span> );</div></pre></td></tr></table></figure>
<ul>
<li><p>外部的函数对象是在<code>global execution context</code>中的创建VO的时候创建的,所以它的<code>[[scope]]</code>属性会指向<code>global object</code>.</p>
</li>
<li><p>当全局环境下的代码执行到调用 <code>outerFunc</code>函数的时候,创建一个新的执行环境(execution context)和outerFunc函数对象的AO/VO, outerFunc的<code>scopechain</code>(作用域链)的前端会指向outerFunc函数对象的AO/VO.链的后端指向outerFunc的函数对象的<code>[[scope]]</code>属性(这里就是 global object).</p>
</li>
<li><p>在为outerFunc生成VO/AO的时候,就会创建innerFunc的函数对象,而这个函数对象的<code>[[scope chain]]</code>会指向innerFunc被创建时的execution context的作用域链(也就是outerFunc的<code>scopechain</code>(作用域链)).  </p>
</li>
<li><p>所有的这些步骤都是自动的而且是决定于代码的结构和代码执行所处的环境.execution context的作用域链定义了函数对象的[[scope]]属性.而函数的[[scope]]属性定义了函数的execution context的范围.</p>
</li>
<li>当执行代码时需要查找指定的变量或者函数时,会顺着作用域链一层一层的向上查找每一层的AO/VO对象,直到global层位置,如果global的VO中都没有包含执行所需的变量或者函数,就会返回undefined.</li>
</ul>
<h2 id="Execution_Context中的AO和VO:">Execution Context中的AO和VO:</h2><p>变量对象(Variable Object)和激活/活动对象(Activation Object)</p>
<h3 id="变量对象(Variable_Object)">变量对象(Variable Object)</h3><p>在不同的环境是指的下面二者中的一个:</p>
<ul>
<li><p>global object,储存着所有的全局变量(像是: 浏览器里的 document或console对象)</p>
</li>
<li><p>Activation object:在一个函数的局部环境下是使用的AO作为VO,定义了ECMAScript的作用域 (这时候: <code>AO===VO //true</code>)</p>
</li>
</ul>
<h3 id="活动对象(Activation_Object)">活动对象(Activation Object)</h3><p>Activation object对象中包含:</p>
<ol>
<li>变量 (var, VariableDeclaration);</li>
<li>函数声明 (FunctionDeclaration, 缩写为FD);</li>
<li>函数的形参(Function formal parameters)和实参(actual parameters/arguments),如果函数被调用时具有实参,形参会在这时就赋值,否则形参被赋值为undefined,注意参数是:按值传参而不是引用).    </li>
</ol>
<p>这就可以解释: 为什么在全局下声明的函数会成为window/global对象的一个属性.</p>
<h3 id="AO和VO区别">AO和VO区别</h3><ul>
<li>global下的VO比函数局部execution context中的AO只是缺少了函数的形参这个属性(因为全局变量不是一个函数,没有参数~).</li>
</ul>
<p>Tips: node.js下全局对象是global,而在浏览器JavaScript中全局对象通常是window.</p>
<p>通过以下代码就可以验证:在全局的execution Context的下的时候,Global object就被当做VO对象使用.</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">var GLOBAL_OBJECT = this;</div><div class="line"></div><div class="line"> /* create global <span class="keyword">property</span><span class="title"> </span>via variable declaration; <span class="keyword">property</span><span class="title"> </span>has DontDelete */</div><div class="line"> var foo = <span class="number">1</span>;</div><div class="line"></div><div class="line"> /* create global <span class="keyword">property</span><span class="title"> </span>via undeclared assignment; <span class="keyword">property</span><span class="title"> </span>has no DontDelete */</div><div class="line"> bar = <span class="number">2</span>;</div><div class="line"></div><div class="line"> delete foo; // <span class="literal">false</span></div><div class="line"> typeof foo; // <span class="string">"number"</span></div><div class="line"></div><div class="line"> delete bar; // <span class="literal">true</span></div><div class="line"> typeof bar; // <span class="string">"undefined"</span></div></pre></td></tr></table></figure>
<p>谈到Execution context,就不能不谈Execution context stack(栈),因为Execution Context的就是在在stack中运行的.</p>
<h2 id="执行栈(Execution_Context_Stack)">执行栈(Execution Context Stack)</h2><p>这个栈有如下几个特点:</p>
<ul>
<li>单线程运行的(Single threaded).</li>
<li>同步执行的(Synchronous execution).</li>
<li>栈只有一个全局环境在栈的底部(Global context).</li>
<li>在这一个全局的执行环境下,他可以创建无限多的子函数的执行环境 </li>
<li>每一个函数都会在运行的时候创建一个新的执行环境push进这个栈中.</li>
</ul>
<h3 id="代码验证:">代码验证:</h3><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">(<span class="function">function <span class="title">foo</span><span class="params">(i)</span> </span>&#123;</div><div class="line">    var n = i; <span class="comment">//i赋值给n,保存被调用时的参数,在函数最后输出.</span></div><div class="line">    console.log(<span class="string">'start run foo(%s):'</span>,i);</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (i === <span class="number">3</span>) &#123;</div><div class="line">    	  console.log(<span class="string">'foo(%s) done &amp; start return '</span>,i);</div><div class="line">          <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        foo(++i);</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    console.log(<span class="string">'foo(%s) done:'</span>,n); </div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;(<span class="number">0</span>));</div><div class="line"></div><div class="line"><span class="comment">// result:</span></div><div class="line">start run foo(<span class="number">0</span>):  //开始运行时 i=0 接着调用自己 foo(++i) 这时候参数是1了;</div><div class="line">start run foo(<span class="number">1</span>):  //在<span class="keyword">else</span>里 调用 foo(2);</div><div class="line">start run foo(<span class="number">2</span>):  //在<span class="keyword">else</span>里 调用 foo(3);</div><div class="line">start run foo(<span class="number">3</span>):  // foo(3)被调用</div><div class="line">foo(3) done &amp; start <span class="keyword">return</span>  // foo(3)函数结束 最晚被调用的函数 最先被执行完.</div><div class="line">foo(2) done: // foo(2) 接着运行 foo(++i)后面的语句</div><div class="line">foo(1) done: // foo(1) 接着运行 foo(++i);后面的语句</div><div class="line">foo(<span class="number">0</span>) done: // foo(0) 接着运行 foo(++i);后面的语句</div></pre></td></tr></table></figure>
<p>运行栈里执行的过程:</p>
<p><img src="http://7xnuw0.com1.z0.glb.clouddn.com/16-6-18/73084259.jpg" alt=""></p>
<p>每当有function被执行时，就会产生一个新的上下文，这一上下文会被压入Js的上下文堆栈（context stack）中，function执行结束后则被弹出，因此Js解释器总是在栈顶上下文中执行。</p>
<h2 id="Execution_Context_生成的过程:">Execution Context 生成的过程:</h2><h3 id="ES5中的解释说明:">ES5中的解释说明:</h3><p>ECMAScript 5的标准中，关于变量声明和作用域（第12.2.2节）的内容:</p>
<blockquote>
<p>如果在一个函数中声明变量，这些变量就被定义在了在该函数的函数作用域中，见第10.1.3所述。不然它们就是被定义在全局的作用域内（即，它们被创建为全局对象的成员，见第10.1.3所述），当进入执行环境的时候，变量就被创建。一个语句块不能定义一个新的作用域。只有一个程序或者函数声明能够产生一个新的作用域。创建变量时，被初始化为undefined。如果变量声明语句里面带有赋值操作，则赋值操作只有被执行到声明语句的时候才会发生，而不是创建的时候。</p>
</blockquote>
<ul>
<li>创建execution context是分为两个阶段被执行的: 创建阶段和运行阶段.</li>
</ul>
<h3 id="创建阶段(Creation_Stage)">创建阶段(Creation Stage)</h3><p>这个阶段是:当函数被调用时,且在执行其中任何一行代码之前时,包括以下三个步骤: </p>
<ol>
<li>初始化作用域链(Scope Chain)</li>
<li>这个阶段会创建一个VO对象(具体内容参考前面1.2的内容).</li>
<li>给Execution Context对应的this指针赋值. </li>
</ol>
<h3 id="执行/赋值阶段(Activation_/_Code_Execution_Stage)">执行/赋值阶段(Activation / Code Execution Stage)</h3><p>解释器解析代码,一行一行的执行代码,并且根据执行的代码,为之前声明创建的变量赋值.(比如:执行到var i =0  时,才为i赋值).</p>
<h3 id="例子:">例子:</h3><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">(i)</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> a = <span class="string">'hello'</span>;</div><div class="line">    <span class="keyword">var</span> b = <span class="function"><span class="keyword">function</span> <span class="title">funcB</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">    &#125;;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">c</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo(<span class="number">123</span>);</div></pre></td></tr></table></figure>
<ul>
<li><p>创建阶段</p>
<p>这里用代码来描述解析器的创建逻辑:</p>
</li>
</ul>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">fooExecutionContext = &#123;</div><div class="line"><span class="symbol">    scopeChain:</span> &#123; ... &#125;, <span class="comment">//生成作用域</span></div><div class="line"><span class="symbol">    variableObject:</span> &#123;</div><div class="line"><span class="symbol">        arguments:</span> &#123;</div><div class="line">            <span class="number">0</span>: <span class="number">123</span>, <span class="comment">//这里直接赋值了 arguments优先级比函数的声明的优先级更高</span></div><div class="line"><span class="symbol">            length:</span> <span class="number">1</span></div><div class="line">        &#125;,</div><div class="line"><span class="symbol">        i:</span> <span class="number">123</span>,  <span class="comment">//这里也已经赋值了</span></div><div class="line"><span class="symbol">        c:</span> pointer to function c()</div><div class="line"><span class="symbol">        a:</span> undefined,</div><div class="line"><span class="symbol">        b:</span> undefined</div><div class="line">    &#125;, <span class="comment">//创建 声明变量和函数和函数的参数,同时要给函数的参数赋值</span></div><div class="line"><span class="symbol">    this:</span> &#123; ... &#125; <span class="comment">//给this 指针赋值</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>PS: 函数的内置变量arguments看起来应该是在普通的函数参数之后才声明，但其实是在函数声明之前。如果参数里面有名称为arguments的参数，它会比内置的那个优先级高，即使它是undefined。所以不要使用arguments作为为函数参数的名称。</p>
<ul>
<li><p>执行/赋值阶段:</p>
<p>这里用代码来描述解析器的赋值执行过程:</p>
</li>
</ul>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">fooExecutionContext = &#123;</div><div class="line">    scopeChain: &#123; ... &#125;,</div><div class="line">    variableObjec<span class="variable">t:</span> &#123;</div><div class="line">        <span class="keyword">argument</span><span class="variable">s:</span> &#123;</div><div class="line">            <span class="number">0</span>: <span class="number">123</span>,</div><div class="line">            length: <span class="number">1</span></div><div class="line">        &#125;,</div><div class="line">        i: <span class="number">123</span>,</div><div class="line">        <span class="keyword">c</span>: pointer <span class="keyword">to</span> <span class="function"><span class="keyword">function</span> <span class="title">c</span><span class="params">()</span> </span></div><div class="line">        <span class="variable">a:</span> <span class="string">'hello'</span>, // <span class="keyword">a</span>被赋值</div><div class="line">        <span class="variable">b:</span> pointer <span class="keyword">to</span> <span class="function"><span class="keyword">function</span> <span class="title">funcB</span><span class="params">()</span> //这时候<span class="title">funcB</span>才赋值给<span class="title">b</span></span></div><div class="line">    &#125;,</div><div class="line">    thi<span class="variable">s:</span> &#123; ... &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里给this赋值的时候，当function是定义在global/window中时，this指向global/window；当function作为Object的一个方法时，this指向该Object：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="number">1</span>;  </div><div class="line"><span class="keyword">var</span> f1 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  </div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.x);</div><div class="line">&#125;</div><div class="line">f1();  <span class="comment">// -&gt; 1</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> f2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  </div><div class="line">  <span class="keyword">this</span>.x = <span class="number">2</span>;</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.x);</div><div class="line">&#125;</div><div class="line">f2(); <span class="comment">// -&gt; 2    //这里因为this定义在global/window中, 所以this.x 实际上指向的global.x</span></div><div class="line">x     <span class="comment">// -&gt; 2    // 这里输出2 证明全局中的x的值被this.x 修改了.</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> o = &#123;<span class="attr">x</span>: <span class="string">"abc"</span>, <span class="attr">f</span>: f1&#125;; <span class="comment">//这里把f赋值为:f1变量所指向的函数 </span></div><div class="line">o.f(); <span class="comment">// "abc"   //因为this指向的是o 所有 this.x 输出abc</span></div></pre></td></tr></table></figure>
<h2 id="变量声明提升(Hoisting)">变量声明提升(Hoisting)</h2><blockquote>
<p>通过上面的代码,我们可以知道:由于变量声明（或其他声明）总是在所有代码执行之前被处理的，所以在代码中的任意位置声明变量总是等效于在代码开头声明。这意味着变量可以在声明或是赋值之前就被初始化，这个行为叫做“hoisting”。“hoisting”就感觉就像是我们是把所有的变量声明移动到函数或者全局代码的开头位置。</p>
</blockquote>
<ul>
<li>参考下面的例子:</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">   </div><div class="line"><span class="built_in">console</span>.log(foo); <span class="comment">// function的指针, 输出: foo()&#123;return 'hello';&#125;</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> foo); <span class="comment">//输出 function  </span></div><div class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> bar); <span class="comment">//输出 undefined </span></div><div class="line"><span class="comment">//因为这里只是声明了变量bar 但是还没有运算到赋值的那行 所以输出 undefined.</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> foo = <span class="string">'hello'</span>;</div><div class="line"><span class="built_in">console</span>.log(foo);  </div><div class="line"><span class="comment">//输出 hello,因为这里又给foo赋值为字符串'hello',覆盖了之前的函数指针.  </span></div><div class="line">    </div><div class="line"><span class="keyword">var</span> bar = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'world'</span>;</div><div class="line">&#125;;</div><div class="line"> 	</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'hello'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="闭包Closure">闭包Closure</h1><p>由上面可以知道JavaScript中只有在三种情况下才会新建一个Execution Context,而不像其他语言那样:{}包裹的代码块都会生成自己的Execution Context作为块级作用域.然而理解了JS的Execution Context后,我们可以使用闭包来模仿块级作用域.</p>
<ul>
<li>如果理解了上文中提到的Execution Context与作用域链(Scope Chain)的机制，再来看闭包(Closure)的概念就很清楚了。每个function在调用时会创建新的Execution Context，而Execution Content中创建的作用域链就是将外层（上层）上下文所绑定的变量对象逐一串连起来，使当前function可以获取外层的Execution Context的VO,this和scopeChain。</li>
<li>如果我们在一个function中定义一个新的function，同时将内层function作为值返回，那么内层function所包含的Exxcution Context将会一起返回，即使内层function在其他Execution Context中执行，其内部的作用域链仍然保持原有的VO对象，而且在运行时,外部的变量无法接触原先内层function中的数据，使得function内部的execution context被保护起来，从而形成“闭包”。</li>
</ul>
<p>看下面的例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">var</span> x =  <span class="number">99</span>;  </div><div class="line"><span class="keyword">var</span> inc = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  </div><div class="line">  <span class="keyword">var</span> x = <span class="number">0</span>;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(x++);</div><div class="line">  &#125;;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> inc1 = inc();  </div><div class="line"><span class="keyword">var</span> inc2 = inc();</div><div class="line"></div><div class="line">inc1();  <span class="comment">// -&gt; 0  </span></div><div class="line">inc1();  <span class="comment">// -&gt; 1  </span></div><div class="line">inc2();  <span class="comment">// -&gt; 0  </span></div><div class="line">inc1();  <span class="comment">// -&gt; 2  </span></div><div class="line">inc2();  <span class="comment">// -&gt; 1  </span></div><div class="line">x;       <span class="comment">// -&gt; 99</span></div></pre></td></tr></table></figure>
<p>执行过程如下图所示，inc内部返回的匿名function在创建时生成的作用域链包括了inc中的x，即使后来赋值给inc1和inc2之后，直接在global context下调用，它们的作用域链仍然是由定义中所处的上下文环境决定，而且由于x是在function inc中定义的，无法被外层的global context所改变，从而实现了闭包的效果：</p>
<h2 id="理解作用域中的this">理解作用域中的this</h2><p>function中的this是由调用function时当前所处的Object环境所决定的,this对象只会在一个函数中需要确定，如果是在全局域下，this永远为Global对象，在浏览器中通常就是window对象。</p>
<h3 id="四种函数调用模式">四种函数调用模式</h3><p><strong>在javascript中，函数的调用一共有4种方式</strong>：</p>
<ol>
<li><p>Function Invocation Pattern (函数直接调用模式)</p>
<p>诸如<code>foo()</code>的调用形式被称为Function Invocation Pattern，是函数最直接的使用形式，注意这里的foo是作为单独的变量出现，而不是属性。<br>在这种模式下，foo函数体中的this永远为Global对象，在浏览器中就是window对象。</p>
</li>
<li><p>Method Invocation Pattern  (对象方法调用模式)</p>
<p>诸如<code>foo.bar()</code>的调用形式被称为Method Invocation Pattern，注意其特点是被调用的函数作为一个对象的属性出现，必然会有“.”或者“[]”这样的关键符号。<br>在这种模式下，bar函数体中的this永远为“.”或“[”前的那个对象，如上例中就一定是foo对象。</p>
</li>
<li><p>Constructor Pattern  (构造函数模式)</p>
<p><code>new foo()</code>这种形式的调用被称为Constructor Pattern，其关键字<code>new</code>就很能说明问题，非常容易识别。<br>在这种模式下，foo函数内部的this永远是new foo()返回的对象。</p>
</li>
<li><p>Apply Pattern  (apply模式)</p>
<p><code>foo.call(thisObject)</code>和<code>foo.apply(thisObject)</code>的形式被称为Apply Pattern，使用了内置的<code>call</code>和<code>apply</code>函数。<br>在这种模式下，<code>call</code>和<code>apply</code>的第一个参数就是foo函数体内的this，如果thisObject是<code>null</code>或<code>undefined</code>，那么会变成Global对象。</p>
</li>
</ol>
<p>所以其实this对象并不像作用域链,它没有一个“查找”的过程。这也是this最容易被混淆用错的一点。记住了上面四种情况,我们来实际验证下是不是这样的.</p>
<p>参考下面的一些例子：</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> name = <span class="string">"global"</span>;  </div><div class="line"><span class="keyword">var</span> obj = &#123;  </div><div class="line">  name: <span class="string">"lyn"</span>,</div><div class="line">  getName: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.name</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//Method Invocation Pattern  对象方法调用模式</span></div><div class="line">obj.getName();  <span class="comment">// -&gt; 输出"lyn"</span></div></pre></td></tr></table></figure>
<p>由于执行obj.getName()时getName所绑定的this是obj，所以此时this == obj；</p>
<p>更容易搞混的是在closure条件下：</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> name = <span class="string">"window"</span>;  </div><div class="line"><span class="keyword">var</span> obj = &#123;  </div><div class="line">  name: <span class="string">"lyn"</span>,</div><div class="line">  getName: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">obj.getName()();  <span class="comment">// -&gt; 输出"window"</span></div></pre></td></tr></table></figure>
<p>此时闭包函数被return后调用相当于：</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">getName = obj.getNameFunc();</div><div class="line">//<span class="keyword">Function</span> <span class="title">Invocation</span> Pattern 函数直接调用模式  </div><div class="line">getName();  // -&gt; <span class="string">"global/window"</span>  因为调用时是在全局下</div></pre></td></tr></table></figure>
<p>换一个更明显的例子：</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;  </div><div class="line">  name: <span class="string">"lyn"</span>,</div><div class="line">  getName: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> obj2 = &#123;  </div><div class="line">  name: <span class="string">"Cheung"</span>,</div><div class="line">  getName: obj.getName() <span class="comment">// 此时闭包函数的this和obj对象绑定在一起</span></div><div class="line">&#125;;</div><div class="line">obj2.getName();  <span class="comment">// -&gt; "Cheung"</span></div></pre></td></tr></table></figure>
<p>当然，有时候为了避免闭包中的this在执行时被替换，可以采取下面的方法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> name = <span class="string">"global"</span>;  </div><div class="line"><span class="keyword">var</span> obj = &#123;  </div><div class="line">  name: <span class="string">"lyn"</span>,</div><div class="line">  </div><div class="line">  getName: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">var</span> <span class="keyword">self</span> = this;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</div><div class="line">       <span class="keyword">return</span> <span class="keyword">self</span>.name;</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line">obj.getName()(); <span class="comment">// -&gt; "lyn"</span></div></pre></td></tr></table></figure>
<p>下面这种就是构造函数模式:</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fn</span><span class="params">(name)</span></span>&#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">    <span class="keyword">this</span>.getName=<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</div><div class="line">     	<span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//Constructor Pattern  (构造函数模式) 带有new关键字</span></div><div class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> Fn(<span class="string">'lyn'</span>);</div><div class="line">a.getName();<span class="comment">//lyn</span></div></pre></td></tr></table></figure>
<p>或者是在调用时强行定义执行的Object：</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> name = <span class="string">"global"</span>;  </div><div class="line"><span class="keyword">var</span> obj = &#123;  </div><div class="line">  name: <span class="string">"lyn"</span>,</div><div class="line">  getNameFunc: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">obj.getNameFunc()();  <span class="comment">// -&gt; "global"  </span></div><div class="line">obj.getNameFunc().bind(obj)(); <span class="comment">// -&gt; "lyn"</span></div></pre></td></tr></table></figure>
<h2 id="使用call,apply和bind的区别">使用call,apply和bind的区别</h2><p>call(),apply(),和bind()方法被用来帮我们定义this的值和传递给函数的参数值。<br>他们的第一个参数都是this，如果thisObject是<code>null</code>或<code>undefined</code>，那么this就会变成Global对象。</p>
<h3 id="区别如下:">区别如下:</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//第二个参数有区别,一个是任意数量的参数 一个是数组</span></div><div class="line"><span class="keyword">var</span> arguments = [arg1,arg2,arg3];</div><div class="line">foo.call(<span class="keyword">this</span>, arg1,arg2,arg3) == foo.apply(<span class="keyword">this</span>, arguments) == <span class="keyword">this</span>.foo(arg1, arg2, arg3)</div></pre></td></tr></table></figure>
<ul>
<li>Function.prototype.call 可以有任意数量的参数，第一个参数被分配给this，剩下的被传递给调用函数。</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Array.prototype.slice.call([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="number">0</span>,<span class="number">2</span>)</div><div class="line"><span class="comment">// 返回 [1, 2]</span></div></pre></td></tr></table></figure>
<ul>
<li>Function.prototype.apply 的行为和.call类似，但它传递给函数的参数是一个数组而不是任意参数。</li>
</ul>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">String</span>.prototype.split.apply(<span class="string">'13.12.02'</span>, [<span class="string">'.'</span>])</div><div class="line">// &lt;- [<span class="string">'13'</span>, <span class="string">'12'</span>, <span class="string">'02'</span>]</div></pre></td></tr></table></figure>
<ul>
<li>Function.prototype.bind 创建一个特殊的函数，该函数将永远使用传递给.bind的参数作为this的值，以及能够分配部分参数，创建原函数的咖喱化（currided）版本。</li>
</ul>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>];</div><div class="line"><span class="keyword">var</span> <span class="keyword">add</span> = <span class="keyword">Array</span>.prototype.push.bind(arr, <span class="number">3</span>);</div><div class="line"></div><div class="line"><span class="comment">// effectively the same as arr.push(3)</span></div><div class="line"><span class="keyword">add</span>();</div><div class="line"></div><div class="line"><span class="comment">// effectively the same as arr.push(3, 4)</span></div><div class="line"><span class="keyword">add</span>(<span class="number">4</span>);</div><div class="line"></div><div class="line">console.log(arr);</div><div class="line"><span class="comment">// &lt;- [1, 2, 3, 3, 4]</span></div></pre></td></tr></table></figure>
<h1 id="关于函数参数传值的问题:">关于函数参数传值的问题:</h1><p>函数调用时候的参数究竟是传递的按引用传递的还是按值传递的呢?<br>这里我们先要搞清楚jJavaScript中的变量分为两种:基本类型 和引用类型</p>
<h2 id="基本类型">基本类型</h2><p>基本类型指的是简单的数据段,包括:</p>
<ul>
<li>undefined</li>
<li>Null</li>
<li>Boolean </li>
<li>Number</li>
<li>String </li>
</ul>
<p>这五种类型是按值访问的,因此可以操作保存在变量的实际值.复制基本类型变量时,原有变量和新建的变量之间是相互独立的,不会相互影响.</p>
<h2 id="引用类型">引用类型</h2><p>引用类型的值是指那些可能由多个基本类型构成的对象,所以引用类型可以看做是是保存在内存中的对象.<br>当从一个变量向另一个变量复制引用类型的值得时候,会将原有的储存在变量对象中的值复制一份到新对象分配的空间中去.而复制的值其实就是一个内存指针,这个指针指向储存在堆中的一个对象.复制完成后,两个变量实际上引用的是相同的一个对象.改变一个变量的值就会影响到另外一个变量.这就是为什么称之为引用类型.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj1 =  <span class="keyword">new</span> <span class="built_in">Object</span>();</div><div class="line"><span class="keyword">var</span> obj2 =  obj1;</div><div class="line">obj1.name=<span class="string">"lyn"</span>;</div><div class="line"><span class="built_in">console</span>.log(obj2.name)<span class="comment">//输出lyn</span></div></pre></td></tr></table></figure>
<h2 id="参数的传值是传递的值而非引用">参数的传值是传递的值而非引用</h2><p>参考下面的例子:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setName</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">	obj.name = <span class="string">"lyn"</span>; <span class="comment">//这是obj的值可以看做person对象的内存地址</span></div><div class="line">	obj = <span class="keyword">new</span> <span class="built_in">Object</span>();</div><div class="line">	obj.name =<span class="string">"cheung"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> <span class="built_in">Object</span>();</div><div class="line">serName(person);</div><div class="line"><span class="built_in">console</span>.log(person.name); </div><div class="line"><span class="comment">//输出 lyn 因为当在函数中new Object的时候. </span></div><div class="line"><span class="comment">//obj原来储存的person的内存地址的值就被新的对象的内存地址覆盖了,</span></div><div class="line"><span class="comment">//这时候obj引用的就是一个局部变量了,</span></div><div class="line"><span class="comment">//就无法再修改函数外的person的name了.所以函数传值是按值传递的而不是按引用传值的.</span></div></pre></td></tr></table></figure>
<p>参考:</p>
<ul>
<li><a href="http://modernweb.com/2013/12/09/demystifying-this-in-javascript/" target="_blank" rel="external">http://modernweb.com/2013/12/09/demystifying-this-in-javascript/</a></li>
<li><a href="http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/" target="_blank" rel="external">http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/</a></li>
<li><a href="http://blog.rainy.im/2015/07/04/scope-chain-and-prototype-chain-in-js/" target="_blank" rel="external">http://blog.rainy.im/2015/07/04/scope-chain-and-prototype-chain-in-js/</a></li>
<li><a href="http://jibbering.com/faq/notes/closures/" target="_blank" rel="external">http://jibbering.com/faq/notes/closures/</a></li>
<li><a href="http://perfectionkills.com/understanding-delete/#activation_object_variable_object" target="_blank" rel="external">http://perfectionkills.com/understanding-delete/#activation_object_variable_object</a></li>
<li><a href="http://dmitrysoshnikov.com/ecmascript/chapter-2-variable-object/" target="_blank" rel="external">http://dmitrysoshnikov.com/ecmascript/chapter-2-variable-object/</a></li>
</ul>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                <a class="post-title-link" href="/2016/03/14/nodeJs-iOnic-Config/" itemprop="url">
                  iOnic Cordova Mac下的开发环境部署
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-03-14T13:53:17+08:00" content="2016-03-14">
              2016-03-14
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="Install_Node-js">Install Node.js</h1><blockquote>
<p>@author: Lyn </p>
</blockquote>
<h2 id="安装Mac软件安装管理器：HomeBrew">安装Mac软件安装管理器：HomeBrew</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ruby <span class="_">-e</span> <span class="string">"<span class="variable">$(curl -fsSL -k https://raw.githubusercontent.com/Homebrew/install/master/install7)</span>"</span></div></pre></td></tr></table></figure>
<h2 id="安装Node-js版本管理器_NVM">安装Node.js版本管理器 NVM</h2><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">brew </span><span class="keyword">install </span>nvm</div></pre></td></tr></table></figure>
<h2 id="使用NVM安装Node-js">使用NVM安装Node.js</h2><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nvm install <span class="keyword">node</span> <span class="title">&amp;&amp; nvm</span> alias default <span class="keyword">node</span><span class="title"></span></div></pre></td></tr></table></figure>
<h2 id="检查Node-js是否安装成功">检查Node.js是否安装成功</h2><p>在终端输入下面的命令检查Node和NPM的版本，安装成功的话会返回版本号：</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">node</span> <span class="title">-v</span></div><div class="line">v4.<span class="number">2.1</span></div><div class="line">npm -v</div><div class="line"><span class="number">2.14</span>.<span class="number">7</span></div></pre></td></tr></table></figure>
<h1 id="Install_Xcode">Install Xcode</h1><blockquote>
<p>（iOS SDK）Apple 开发者网站可以下载Xcode 或者AppStore安装 </p>
</blockquote>
<h1 id="Install_Cordova,_Ionic">Install Cordova, Ionic</h1><figure class="highlight gams"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta"><span class="meta-keyword">$sudo</span> npm install cordova ionic ios-sim -g</span></div></pre></td></tr></table></figure>
<h1 id="Install_JAVA">Install JAVA</h1><p>Java SE Development  Kit</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http:<span class="regexp">//</span>www.oracle.com<span class="regexp">/technetwork/</span>java<span class="regexp">/javase/</span>downloads<span class="regexp">/jdk7-downloads-1880260.html</span></div></pre></td></tr></table></figure>
<h1 id="Install_Android_sdk">Install Android sdk</h1><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">brew </span><span class="keyword">install </span><span class="keyword">android-sdk</span></div></pre></td></tr></table></figure>
<h2 id="Android_Studio_(选装)">Android Studio (选装)</h2><blockquote>
<p><a href="https://developer.android.com/sdk/index.html" target="_blank" rel="external">https://developer.android.com/sdk/index.html</a></p>
</blockquote>
<h1 id="Install_Git">Install Git</h1><p> 终端安装Git 如果安装过，请跳过。</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">brew </span><span class="keyword">install </span>git</div></pre></td></tr></table></figure>
<p>如果是想更新Git版本：</p>
<p>先安装：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">brew </span><span class="keyword">install </span>git</div></pre></td></tr></table></figure>
<p>然后新建一个目录，把原来的移动到这个目录去<br>命令如下：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo cd /usr/bin</div><div class="line">sudo mkdir old-git<span class="number">-1.7</span><span class="number">.5</span><span class="number">.4</span></div><div class="line">sudo mv git* old-git<span class="number">-1.7</span><span class="number">.5</span><span class="number">.4</span></div></pre></td></tr></table></figure>
<h1 id="Install_Apache_Ant">Install Apache Ant</h1><blockquote>
<p>还是使用 brew</p>
</blockquote>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">brew </span><span class="keyword">install </span>ant</div></pre></td></tr></table></figure>
<h1 id="Add_Android_sdk_in_your_path">Add Android sdk in your path</h1><blockquote>
<p>在终端打开和编辑: “.bash_profile” - 添加以下变量:</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">export</span> JAVA_HOME=$(/usr/libexec/java_home)</div><div class="line"><span class="built_in">export</span> PATH=<span class="variable">$&#123;JAVA_HOME&#125;</span>/bin:<span class="variable">$PATH</span></div><div class="line"><span class="built_in">export</span> PATH=/usr/<span class="built_in">local</span>/bin:<span class="variable">$PATH</span></div><div class="line"><span class="built_in">export</span> JAVA_HOME=<span class="string">"/usr/libexec/java_home -v '1.7*'"</span></div><div class="line"><span class="built_in">export</span> ANDROID_HOME=/usr/<span class="built_in">local</span>/opt/android-sdk</div></pre></td></tr></table></figure>
<p>如果还安装了Android Studio，还需要添加这一行： </p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">export PATH=<span class="variable">$&#123;PATH&#125;</span>:<span class="regexp">/Applications/</span>Android\ Studio.app<span class="regexp">/sdk/</span>platform-tools:<span class="regexp">/Applications/</span>Android\ Studio.app<span class="regexp">/sdk/</span>tools</div></pre></td></tr></table></figure>
<h1 id="Restart_Ur_Mac">Restart Ur Mac</h1><p>或者使用这个命令重新加载环境变量：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">source</span> ~/.bash_profile</div></pre></td></tr></table></figure>
<p>检查环境变量：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">echo $PATH </div><div class="line"><span class="regexp">/usr/</span>local<span class="regexp">/bin:/</span>Library<span class="regexp">/Java/</span>JavaVirtualMachines<span class="regexp">/jdk1.7.0_79.jdk/</span>Contents<span class="regexp">/Home/</span><span class="string">bin:</span><span class="regexp">/usr/</span>local<span class="regexp">/bin:/</span>Library<span class="regexp">/Java/</span>JavaVirtualMachines<span class="regexp">/jdk1.7.0_79.jdk/</span>Contents<span class="regexp">/Home/</span><span class="string">bin:</span><span class="regexp">/usr/</span>local<span class="regexp">/bin:/</span>Library<span class="regexp">/Java/</span>JavaVirtualMachines<span class="regexp">/jdk1.7.0_79.jdk/</span>Contents<span class="regexp">/Home/</span><span class="string">bin:</span><span class="regexp">/usr/</span>local<span class="regexp">/bin:/</span>usr<span class="regexp">/bin:/</span><span class="string">bin:</span><span class="regexp">/usr/</span><span class="string">sbin:</span><span class="regexp">/sbin:/</span>Development<span class="regexp">/android-sdk/</span>platform-<span class="string">tools:</span><span class="regexp">/Development/</span>android-sdk<span class="regexp">/tools:/</span>Development<span class="regexp">/android-sdk/</span><span class="string">tools:</span><span class="regexp">/Development/</span>android-sdk<span class="regexp">/tools:/</span>Development<span class="regexp">/android-sdk/</span><span class="string">tools:</span><span class="regexp">/Development/</span>android-sdk<span class="regexp">/tools:/</span>Development<span class="regexp">/android-sdk/</span>tools</div></pre></td></tr></table></figure>
<h1 id="建立一个新的项目">建立一个新的项目</h1><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ ionic start oneApp</div><div class="line">$ cd oneApp</div><div class="line">$ ionic platform <span class="keyword">add</span><span class="bash"> ios</span></div><div class="line">$ ionic platform <span class="keyword">add</span><span class="bash"> android</span></div></pre></td></tr></table></figure>
<p>编译这个空项目：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">ionic</span> <span class="keyword">build </span>ios</div></pre></td></tr></table></figure>
<p>启动模拟器来显示新建的项目：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ionic <span class="built_in">emulate</span> ios</div></pre></td></tr></table></figure>
<p>如果遇到文件权限的问题，修改文件权限：</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>sudo chmod -R <span class="number">777</span> ~<span class="regexp">/.yourfile</span></div></pre></td></tr></table></figure>
<h1 id="其他的Cordova的命令：">其他的Cordova的命令：</h1><h2 id="Create_New_Project">Create New Project</h2> <figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>cordova create hello com.example.hello <span class="string">"HelloWorld"</span></div><div class="line"><span class="variable">$ </span>cd hello</div><div class="line"><span class="variable">$ </span>cordova platform add ios</div><div class="line"><span class="variable">$ </span>cordova prepare</div></pre></td></tr></table></figure>
<h2 id="Deploy_the_app">Deploy the app</h2><figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>cordova build</div></pre></td></tr></table></figure>
<h2 id="部署App到iOS设备:">部署App到iOS设备:</h2><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ cordova <span class="built_in">run</span> ios <span class="comment">--device</span></div></pre></td></tr></table></figure>
<h2 id="部署App到iOS_xCode模拟器">部署App到iOS xCode模拟器</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ cordova <span class="built_in">emulate</span> ios</div></pre></td></tr></table></figure>
<h2 id="查看所有可以用的模拟器列表">查看所有可以用的模拟器列表</h2><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cordova <span class="built_in">run</span> ios <span class="comment">--list</span></div></pre></td></tr></table></figure>
<h2 id="使用指定的手机模拟器">使用指定的手机模拟器</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cordova <span class="keyword">run</span><span class="bash"> ios --target=target_name  </span></div><div class="line">cordova <span class="keyword">run</span><span class="bash"> ios --target=<span class="string">"iPhone-6"</span>) //指定使用iPhone6作为模拟器</span></div></pre></td></tr></table></figure>
<h1 id="参考链接">参考链接</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">http:<span class="regexp">//i</span>onicframework.com<span class="regexp">/getting-started/</span></div><div class="line">http:<span class="regexp">//</span>cordova.apache.org<span class="regexp">/docs/</span>en<span class="regexp">/latest/gui</span>de<span class="regexp">/platforms/</span>android<span class="regexp">/index.html</span></div></pre></td></tr></table></figure>
            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                <a class="post-title-link" href="/2016/03/10/nodejs-gulp-01/" itemprop="url">
                  Node.js gulp notes
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-03-10T21:43:06+08:00" content="2016-03-10">
              2016-03-10
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="Your_first_gulp_file">Your first  gulp file</h1><p>new gulpfile.js  in your PWD </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp =  <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'hello world!'</span>);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="install_Gulp">install  Gulp</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">// <span class="keyword">install</span> gulp  gloablly</div><div class="line">sudo npm <span class="keyword">install</span> -g gulp</div><div class="line"></div><div class="line">// <span class="keyword">then</span> chang <span class="keyword">to</span> your pwd</div><div class="line">npm <span class="keyword">install</span> <span class="comment">--save-dev gulp</span></div><div class="line"></div><div class="line">// run gulp  <span class="keyword">in</span> your pwd </div><div class="line">gulp</div><div class="line">[<span class="number">21</span>:<span class="number">41</span>:<span class="number">05</span>] <span class="keyword">Using</span> gulpfile ~/src/node/casher/gulpfile.js</div><div class="line">[<span class="number">21</span>:<span class="number">41</span>:<span class="number">05</span>] <span class="keyword">Starting</span> <span class="string">'default'</span>...</div><div class="line">hello world!</div><div class="line">[<span class="number">21</span>:<span class="number">41</span>:<span class="number">05</span>] Finished <span class="string">'default'</span> <span class="keyword">after</span> <span class="number">90</span> μs</div></pre></td></tr></table></figure>
<h1 id="install_plugins_form_http://gulpjs-com/plugins/">install  plugins  form <a href="http://gulpjs.com/plugins/" target="_blank" rel="external">http://gulpjs.com/plugins/</a></h1><p>minify the Js file size  is  the most common things, when we are using  gulp</p>
<h2 id="Installation">Installation</h2><p>Install package with NPM and add it to your development dependencies:<br><figure class="highlight q"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --<span class="built_in">save</span>-<span class="built_in">dev</span> gulp-uglify</div></pre></td></tr></table></figure></p>
<h2 id="Usage">Usage</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);</div><div class="line"> </div><div class="line">gulp.task(<span class="string">'compress'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'lib/*.js'</span>)</div><div class="line">    .pipe(uglify())</div><div class="line">    .pipe(gulp.dest(<span class="string">'dist'</span>));</div><div class="line">&#125;);check the Api https:<span class="comment">//www.npmjs.com/package/gulp-uglify/</span></div></pre></td></tr></table></figure>
<h2 id="running_in_our_PWD">running in our PWD</h2><p>gulpfile.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp =  <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);	</div><div class="line"></div><div class="line">gulp.task(<span class="string">'scripts'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	 gulp.src(<span class="string">'src/*.js'</span>)</div><div class="line">	  .pipe(uglify())</div><div class="line">	  .pipe(gulp.dest(<span class="string">'dist'</span>));</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>run our  code </p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">gulp scripts</div><div class="line"></div><div class="line">[<span class="number">22</span>:<span class="number">14</span>:<span class="number">54</span>] <span class="symbol">Using</span> gulpfile ~/src/node/casher/gulpfile.js</div><div class="line">[<span class="number">22</span>:<span class="number">14</span>:<span class="number">54</span>] <span class="symbol">Starting</span> <span class="string">'scripts'</span>...</div><div class="line">[<span class="number">22</span>:<span class="number">14</span>:<span class="number">54</span>] <span class="symbol">Finished</span> <span class="string">'scripts'</span> after <span class="number">8.18</span> ms</div></pre></td></tr></table></figure>
<p>I copy gulpfile.js  to src folder</p>
<p>and in ./dest/ folder it trim all the blank  and turn all the codes into one line.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp=<span class="built_in">require</span>(<span class="string">"gulp"</span>),uglify=<span class="built_in">require</span>(<span class="string">"gulp-uglify"</span>);gulp.task(<span class="string">"scripts"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;gulp.src(<span class="string">"src/*.js"</span>).pipe(uglify()).pipe(gulp.dest(<span class="string">"dist"</span>))&#125;);</div></pre></td></tr></table></figure>
<h2 id="gulp-concat:_Concat_your_js_file">gulp-concat: Concat your js file</h2><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">npm</span> <span class="selector-tag">install</span> <span class="selector-tag">gulp-concat</span> <span class="selector-tag">--save-dev</span></div><div class="line"></div><div class="line"><span class="selector-tag">gulp-concat</span>@<span class="selector-tag">2</span><span class="selector-class">.6</span><span class="selector-class">.0</span> <span class="selector-tag">node_modules</span>/<span class="selector-tag">gulp-concat</span></div><div class="line">├── <span class="selector-tag">concat-with-sourcemaps</span>@<span class="selector-tag">1</span><span class="selector-class">.0</span><span class="selector-class">.4</span> (source-map<span class="variable">@0</span>.<span class="number">5.3</span>)</div><div class="line">├── <span class="selector-tag">through2</span>@<span class="selector-tag">0</span><span class="selector-class">.6</span><span class="selector-class">.5</span> (xtend<span class="variable">@4</span>.<span class="number">0.1</span>, readable-stream<span class="variable">@1</span>.<span class="number">0.33</span>)</div><div class="line">└── <span class="selector-tag">gulp-util</span>@<span class="selector-tag">3</span><span class="selector-class">.0</span><span class="selector-class">.7</span> (array-differ<span class="variable">@1</span>.<span class="number">0.0</span>, array-uniq<span class="variable">@1</span>.<span class="number">0.2</span>, beeper<span class="variable">@1</span>.<span class="number">1.0</span>, object-assign<span class="variable">@3</span>.<span class="number">0.0</span>, lodash._reevaluate<span class="variable">@3</span>.<span class="number">0.0</span>, lodash._reinterpolate<span class="variable">@3</span>.<span class="number">0.0</span>, lodash._reescape<span class="variable">@3</span>.<span class="number">0.0</span>, replace-ext<span class="variable">@0</span>.<span class="number">0.1</span>, minimist<span class="variable">@1</span>.<span class="number">2.0</span>, multipipe<span class="variable">@0</span>.<span class="number">1.2</span>, has-gulplog<span class="variable">@0</span>.<span class="number">1.0</span>, fancy-log<span class="variable">@1</span>.<span class="number">2.0</span>, vinyl<span class="variable">@0</span>.<span class="number">5.3</span>, gulplog<span class="variable">@1</span>.<span class="number">0.0</span>, through2<span class="variable">@2</span>.<span class="number">0.1</span>, lodash.template<span class="variable">@3</span>.<span class="number">6.2</span>, chalk<span class="variable">@1</span>.<span class="number">1.1</span>, dateformat<span class="variable">@1</span>.<span class="number">0.12</span>)</div></pre></td></tr></table></figure>
<p>gulpfile.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//config file</span></div><div class="line"><span class="keyword">var</span> gulp =  <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);	</div><div class="line"><span class="keyword">var</span> concat = <span class="built_in">require</span>(<span class="string">'gulp-concat'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'scripts'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	 gulp.src(<span class="string">'src/*.js'</span>)</div><div class="line">	  .pipe(concat(<span class="string">'all.min.js'</span>))</div><div class="line">	  .pipe(uglify())</div><div class="line">	  .pipe(gulp.dest(<span class="string">'dist'</span>));</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>Running results: &gt; all.min.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFirstFunction</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">"first"</span>&#125;<span class="function"><span class="keyword">function</span> <span class="title">mySecondFunction</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">"Second"</span>&#125;<span class="keyword">var</span> gulp=<span class="built_in">require</span>(<span class="string">"gulp"</span>),uglify=<span class="built_in">require</span>(<span class="string">"gulp-uglify"</span>);gulp.task(<span class="string">"scripts"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;gulp.src(<span class="string">"src/*.js"</span>).pipe(uglify()).pipe(gulp.dest(<span class="string">"dist"</span>))&#125;);</div></pre></td></tr></table></figure>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                <a class="post-title-link" href="/2016/03/05/javaScript-Object-Oriented-Prototype-link/" itemprop="url">
                  JavaScript使用原型链实现继承以及Es6中的实现
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-03-05T22:49:33+08:00" content="2016-03-05">
              2016-03-05
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="JavaScript使用原型链实现继承">JavaScript使用原型链实现继承</h1><ul>
<li>ECMAScript 支持面向对象编程,但在ES6之前不使用类或者接口.</li>
</ul>
<h1 id="原型链">原型链</h1><ul>
<li><p>JavaScript主要是通过原型链(prototype chain)来实现的继承,原型链的实现是通过创建”超类”的一个实例并且把这个实例赋值给”子类”构造函数的prototype指针.这样子类型就可以访问超类里的所有方法和属性.</p>
</li>
<li><p><img src="http://7xnuw0.com1.z0.glb.clouddn.com/16-6-15/87102920.jpg" alt=""></p>
</li>
</ul>
<h1 id="原型式继承">原型式继承</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//超类的构造函数</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">this</span>.property = <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">//给超类定义共享的原型方法</span></div><div class="line">SuperType.prototype.getSuperValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">this</span>.subproperty = <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">//子类的构造函数</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">this</span>.subproperty = <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//这里实现继承</span></div><div class="line">SubType.prototype = <span class="keyword">new</span> SuperType();</div><div class="line"></div><div class="line">SubType.prototype.getSubValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">this</span>.subproperty;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> instance = <span class="keyword">new</span> SubType();</div><div class="line"><span class="built_in">console</span>.log(instance.getSuperValue()); <span class="comment">//true</span></div><div class="line"></div><div class="line"><span class="comment">//确定原型和实例的关系</span></div><div class="line"><span class="built_in">console</span>.log(instance <span class="keyword">instanceof</span> <span class="built_in">Object</span>)       <span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(instance <span class="keyword">instanceof</span> SuperType)    <span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(instance <span class="keyword">instanceof</span> SubType)      <span class="comment">//true		</span></div><div class="line"><span class="comment">//正确的增加定义子类的方法</span></div><div class="line">SubType.prototype.getSubVaule = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">this</span>.subproperty;</div><div class="line">&#125;</div><div class="line"><span class="comment">//正确的重写超类的方法</span></div><div class="line">SubType.prototype.getSuperValue =<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">//错误的定义方法会导致继承失效.</span></div><div class="line">SubType.prototype = &#123;</div><div class="line">	<span class="attr">someMethod</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="comment">// method do something</span></div><div class="line">	&#125;	</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> anotherInstance = <span class="keyword">new</span> SubType();</div><div class="line"><span class="built_in">console</span>.log(getSuperValue()); <span class="comment">// error 因为上面的代码将子类的prototype从指向超累的一个实例替换成了一个对象字面量.</span></div></pre></td></tr></table></figure>
<h2 id="优点&amp;缺点">优点&amp;缺点</h2><ul>
<li>所有的子类实例都共享超累的属性,如果修改了超类的属性那么新建的实例都会受到影响</li>
<li>创建子类型实例的时候,不能在不影响所有对象实例的前提下向超类型的构造函数传递参数.</li>
</ul>
<h2 id="ES5中的的原型式继承">ES5中的的原型式继承</h2><p> 如果只需要一个对象与另一个对象保持类似,而且在不同的对象之间共享相同的引用类型的的值的情况下可以使用这种Object.create方法.相当于把传入的对象(第一个参数)进行一次浅复制.这个特性会在后面的寄生组合式继承中用到.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> person=&#123;</div><div class="line">	<span class="attr">name</span>:<span class="string">"lyn"</span>,</div><div class="line">	<span class="attr">numbers</span>:[<span class="string">"1"</span>,<span class="string">"2"</span>,<span class="string">"3"</span>]</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> anotherPerson = <span class="built_in">Object</span>.create(person);</div><div class="line">anotherPerson.name= <span class="string">"Cheung"</span>; <span class="comment">//覆盖原型对象中的值</span></div><div class="line">anotherPerson.numbers.push(<span class="string">"5"</span>); <span class="comment">//修改共享的原型对象的属性</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> otherPerson = <span class="built_in">Object</span>.create(person,&#123;</div><div class="line">		<span class="attr">name</span>:&#123;</div><div class="line">			<span class="attr">value</span>:<span class="string">"Lee"</span></div><div class="line">		&#125;</div><div class="line">&#125;); <span class="comment">//第二个参数会覆盖原型对象上的同名属性</span></div><div class="line">otherPerson.numbers.push(<span class="string">"6"</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(person.numbers)<span class="comment">// "1,2,3,5,6"</span></div></pre></td></tr></table></figure>
<h1 id="借用构造函数继承">借用构造函数继承</h1><p>为了实现向超类的构造函数传递参数,可以使用借用构造函数继承</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">SuperType(name)&#123;</div><div class="line">   <span class="keyword">this</span>.name = name;</div><div class="line">   <span class="keyword">this</span>.colors=[<span class="string">'red'</span>,<span class="string">'green'</span>,<span class="string">'yellow'</span>];</div><div class="line">&#125;</div><div class="line">SubType()&#123;</div><div class="line">	<span class="comment">//实现继承</span></div><div class="line">	SuperType.call(<span class="keyword">this</span>,<span class="string">"lyn"</span>);<span class="comment">//在构造函数中给属性或方法赋值</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> instance1 = <span class="keyword">new</span> SubType();</div><div class="line">instance1.colors.push(<span class="string">"black"</span>);</div><div class="line"><span class="built_in">console</span>.log(instance1.colors);<span class="comment">//"red,green,yellow,black"</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> instance2 = <span class="keyword">new</span> SubType();</div><div class="line"><span class="built_in">console</span>.log(instance2.colors);<span class="comment">//"red,blue,green"</span></div></pre></td></tr></table></figure>
<h2 id="优点&amp;缺点-1">优点&amp;缺点</h2><ul>
<li>因为只借用了构造函数,所以构造函数模式的弊端(参考前一篇blog):所有方法和属性都在构造函数中定义,相同的功能的函数都是不同的实例,因此函数复用就无从谈起了.</li>
<li>在超类的原型中定义的方法对于子类型来说也是不可见的.</li>
</ul>
<h1 id="组合式继承(combination_inheritance)">组合式继承(combination inheritance)</h1><p>组合继承:将原型链模式和借用构造函数模式相结合,发挥二者长处的一种模式.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name</span>)</span>&#123;</div><div class="line">	<span class="keyword">this</span>.name =name;</div><div class="line">	<span class="keyword">this</span>.colors=[<span class="string">"red"</span>,<span class="string">"blue"</span>,<span class="string">"green"</span>];</div><div class="line">&#125;</div><div class="line">SuperType.prototype.sayName =<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params">name,age</span>)</span>&#123;</div><div class="line">	<span class="comment">//继承方法,传递参数</span></div><div class="line">	SuperType.call(<span class="keyword">this</span>,name);</div><div class="line">	<span class="keyword">this</span>.age = age;</div><div class="line">&#125;</div><div class="line">SubType.prototype = <span class="keyword">new</span> SuperType();</div><div class="line">SubType.prototype.constructor= SubType;</div><div class="line">SubType.prototype.sayAge =<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="keyword">this</span>.age);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> instance1 = <span class="keyword">new</span> SubType(<span class="string">"lyn"</span>,<span class="number">27</span>);</div><div class="line">instance1.colors.push(<span class="string">"black"</span>);</div><div class="line"><span class="built_in">console</span>.log(instance1.colors); <span class="comment">//"red, blue, green, black"</span></div><div class="line">instance1.sayName();   <span class="comment">//lyn</span></div><div class="line">instance1.sayAge();	<span class="comment">//27	</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> instance2 = <span class="keyword">new</span> SubType(<span class="string">"Cheung"</span>,<span class="number">23</span>);</div><div class="line"><span class="built_in">console</span>.log(instance2.colors); <span class="comment">// "red,blue,green"</span></div><div class="line">instance2.sayName();    <span class="comment">// "Cheung"</span></div><div class="line">instance2.sayAge();  	<span class="comment">//  23</span></div></pre></td></tr></table></figure>
<p>实现步骤:</p>
<ol>
<li>SuperType在自己的构造函数中定义了2个属性: name,colors</li>
<li>SuperType的原型中定义了自己的方法sayName.</li>
<li>SubType的构造函数在调用SuperType的构造函数的时候传入了name参数</li>
<li>SubType的原型中也定义了自己的方法sayAge</li>
</ol>
<p>这样两个不同的实例就可以拥有不同的属性但是共享/复用同样的方法了.</p>
<h2 id="优点&amp;缺点-2">优点&amp;缺点</h2><h3 id="优点:">优点:</h3><ul>
<li>避免了原型链和借用构造函数的缺点,融合了他们的优点</li>
<li>instanceof 和 isPrototypeOf() 也能识别组合式继承实现的对象.</li>
</ul>
<h3 id="缺点:">缺点:</h3><ul>
<li>调用了两次SuperType的构造函数:(第一次是在把SuperType的实例赋值给SubType的原型时 ,第二次 是在SubType的构造函数中又call了一次).这个可以使用寄生组合继承来解决</li>
</ul>
<h1 id="寄生组合式继承">寄生组合式继承</h1><p>通过借用构造函数来继承属性,通过使用Object.create方法对SuperType的prototype进行浅复制实现对超类的继承,然后再将结果指定给子类型的原型.寄生组合式继承的基本模式如下:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">inheritPrototype</span>(<span class="params">subType,superType</span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> prototypeTemp =<span class="built_in">Object</span>.create(superType.prototype); <span class="comment">//创建超类型原型的副本</span></div><div class="line">	prototypeTemp.constructor = subType;  <span class="comment">//为创建的副本指定构造函数</span></div><div class="line">	subType.prototype = prototypeTemp;   <span class="comment">//将创建的副本赋值给子类的原型</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Object.create方法可以简单理解为是使用Object.setPrototypeOf()方法设置原型.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">objectCreate</span>(<span class="params">proto</span>)</span>&#123;</div><div class="line">	<span class="keyword">const</span> obj=&#123;&#125;</div><div class="line">	<span class="built_in">Object</span>.setPrototypeOf(Obj,proto)</div><div class="line">	<span class="keyword">return</span> obj</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>有了这个函数我们就可以替换掉组合式继承中为子类原型赋值的语句了.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name</span>)</span>&#123;</div><div class="line">	<span class="keyword">this</span>.name =name;</div><div class="line">	<span class="keyword">this</span>.colors=[<span class="string">"red"</span>,<span class="string">"blue"</span>,<span class="string">"green"</span>];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>.<span class="title">prototype</span>.<span class="title">sayName</span> =<span class="title">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params">name,age</span>)</span>&#123;</div><div class="line">	<span class="comment">//继承方法,传递参数</span></div><div class="line">	SuperType.call(<span class="keyword">this</span>,name);</div><div class="line">	<span class="keyword">this</span>.age = age;</div><div class="line">&#125;</div><div class="line"></div><div class="line">inheritPrototype(SubType,SuperType); <span class="comment">//为子类原型赋值</span></div><div class="line"></div><div class="line">SubType.prototype.sayAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="keyword">this</span>.age);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="优点&amp;缺点:">优点&amp;缺点:</h2><ul>
<li>只调用了一次SuperType构造函数,这样就避免了SubType.prototype重复创建属性.</li>
<li>原型链可以保持不变,因此可以使用instanceof 和 isPrototypeOf()检测创建的对象</li>
<li>寄生组合式继承是引用类型最理想的继承范式.</li>
</ul>
<h1 id="总结:">总结:</h1><ul>
<li>prototype上的方法或者属性可以实现共享</li>
<li>构造函数通过call来绑定this到子类上, 子类因为使用<code>new</code>关键字就会生成一个新的对象,因此每个对象都可以通过这种方式实现不共享的属性或者方.</li>
<li>Object.create()方法相当于设置prototype,所以创建出来的属性和方法也是共享的</li>
</ul>
<h1 id="ES6中的继承实现">ES6中的继承实现</h1><p>Es6中有了extends 关键字可以实现继承,而不用在关心借用构造函数或者原型链来实现.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</div><div class="line">    constructor(name, age)&#123;</div><div class="line">        public name = name;</div><div class="line">        public age  = age;</div><div class="line">        </div><div class="line">        sayName()&#123;</div><div class="line">            console.log(<span class="keyword">this</span>.name);     </div><div class="line">        &#125;</div><div class="line">        getOlder(years)&#123;</div><div class="line">            <span class="keyword">this</span>.age += years;  </div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span> <span class="keyword">extends</span> <span class="title">Person</span></span>&#123;</div><div class="line">	constructor(name,age)&#123;</div><div class="line">		<span class="keyword">super</span>(name,age); <span class="comment">//借用Person的构造函数</span></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面的代码与西面的代码实现了相同的继承效果</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Employee</span><span class="params">(name,age)</span></span>&#123;</div><div class="line">	Person.call(<span class="keyword">this</span>,name,age);</div><div class="line">&#125;</div><div class="line">Employee.prototype = <span class="keyword">new</span> Person;</div></pre></td></tr></table></figure>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



        </div>

        


        

      </div>

      
        
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/images/author.png" alt="Lyn's Blog" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Lyn's Blog</p>
        </div>
        <p class="site-description motion-element" itemprop="description">Lyn's Blog about Node.js  Express.js Angular.js HTML5 Mongodb Programing Notes</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">60</span>
              <span class="site-state-item-name">文章</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">0</span>
              <span class="site-state-item-name">分類</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">32</span>
              <span class="site-state-item-name">標籤</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


      
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2011 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lyn's Blog</span>
</div>

<div class="powered-by">
  <a class="theme-link" href="http://hexo.io">Powered by Hexo
  </a>
</div>

<div class="theme-info">
  
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>

</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
    
    

  


  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.2"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.2"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
<script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

<script type="text/javascript" src="/js/motion.js?v=0.4.5.2" id="motion.global"></script>


  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  

  <script type="text/javascript" src="/js/bootstrap.js"></script>

  
  

  
  

</body>
</html>
